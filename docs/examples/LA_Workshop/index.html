<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-examples/LA_Workshop" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">1st Latin American hands-on workshop on open source AI/ML guided drug discovery | TidyScreen</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://alfredoq.github.io/TidyScreen_v2_docs_new/img/tidyscreen_logo.png"><meta data-rh="true" name="twitter:image" content="https://alfredoq.github.io/TidyScreen_v2_docs_new/img/tidyscreen_logo.png"><meta data-rh="true" property="og:url" content="https://alfredoq.github.io/TidyScreen_v2_docs_new/docs/examples/LA_Workshop"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="1st Latin American hands-on workshop on open source AI/ML guided drug discovery | TidyScreen"><meta data-rh="true" name="description" content="Authors: ... Juan Pablo Cerutti (jpcerutti@unc.edu.ar) – October 2025"><meta data-rh="true" property="og:description" content="Authors: ... Juan Pablo Cerutti (jpcerutti@unc.edu.ar) – October 2025"><link data-rh="true" rel="icon" href="/TidyScreen_v2_docs_new/img/tidyscreen_logo.png"><link data-rh="true" rel="canonical" href="https://alfredoq.github.io/TidyScreen_v2_docs_new/docs/examples/LA_Workshop"><link data-rh="true" rel="alternate" href="https://alfredoq.github.io/TidyScreen_v2_docs_new/docs/examples/LA_Workshop" hreflang="en"><link data-rh="true" rel="alternate" href="https://alfredoq.github.io/TidyScreen_v2_docs_new/docs/examples/LA_Workshop" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/TidyScreen_v2_docs_new/blog/rss.xml" title="TidyScreen RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/TidyScreen_v2_docs_new/blog/atom.xml" title="TidyScreen Atom Feed"><link rel="stylesheet" href="/TidyScreen_v2_docs_new/assets/css/styles.f7cb7648.css">
<script src="/TidyScreen_v2_docs_new/assets/js/runtime~main.9a41c922.js" defer="defer"></script>
<script src="/TidyScreen_v2_docs_new/assets/js/main.63a86001.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/TidyScreen_v2_docs_new/img/tidyscreen_logo.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/TidyScreen_v2_docs_new/"><div class="navbar__logo"><img src="/TidyScreen_v2_docs_new/img/tidyscreen_logo.png" alt="TidyScreen" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/TidyScreen_v2_docs_new/img/tidyscreen_logo.png" alt="TidyScreen" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">HomePage</b></a><a class="navbar__item navbar__link" href="/TidyScreen_v2_docs_new/docs/project_overview">Documentation</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>1st Latin American hands-on workshop on open source AI/ML guided drug discovery</h1></header><p><strong>Authors:</strong> ... <em>Juan Pablo Cerutti (<a href="mailto:jpcerutti@unc.edu.ar" target="_blank" rel="noopener noreferrer">jpcerutti@unc.edu.ar</a>) – October 2025</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-replication-of-the-crystallographic-binding-mode-of-k777">1. Replication of the crystallographic binding mode of K777<a href="#1-replication-of-the-crystallographic-binding-mode-of-k777" class="hash-link" aria-label="Direct link to 1. Replication of the crystallographic binding mode of K777" title="Direct link to 1. Replication of the crystallographic binding mode of K777">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-receptor-preparation">1.1. Receptor preparation<a href="#11-receptor-preparation" class="hash-link" aria-label="Direct link to 1.1. Receptor preparation" title="Direct link to 1.1. Receptor preparation">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="111-download-clean-and-parametrize-the-crystal">1.1.1. Download, clean and parametrize the crystal<a href="#111-download-clean-and-parametrize-the-crystal" class="hash-link" aria-label="Direct link to 1.1.1. Download, clean and parametrize the crystal" title="Direct link to 1.1.1. Download, clean and parametrize the crystal">​</a></h4>
<p>The first step consists of preparing the targets from the crystallographic structures so that they can be used by AutoDock.<br>
<!-- -->This involves downloading the structure, removing non-essential molecules (ligand, solvent, crystallization agents), adding hydrogens at physiological pH, and finally generating a parameterized <code>.pdbqt</code> file with the correct atom types and charges.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Download PDB of hCatL in complex with K777</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wget https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">//</span><span class="token plain">files</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rcsb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">org</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">download</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">8hfv</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pdb </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Download PDB of CZP in complex with K777</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wget https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">//</span><span class="token plain">files</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rcsb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">org</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">download</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">2OZ2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pdb </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Align</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lovoalign </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">p1 2OZ2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pdb </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">p2 8hfv</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pdb </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">o CZP_2oz2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p><a href="/TidyScreen_v2_docs_new/assets/files/8hfv-984b9685876d8ca8a0650e2f3a4c7b17.pdb" target="_blank">Download 8hfv</a></p>
<p><a href="/TidyScreen_v2_docs_new/assets/files/2OZ2-9342aedf9e01a46ac763ba3546e0181a.pdb" target="_blank">Download 2OZ2</a></p>
<p><a href="/TidyScreen_v2_docs_new/assets/files/hCatL-d9323b202b3220d6101965d94af246cd.pdb" target="_blank">Download hCatL (pdb file we&#x27;ve been using PDB: 3OF8)</a></p>
<p><a href="/TidyScreen_v2_docs_new/assets/files/CZP1-bed03d73a34d555b4c79b55714b3c70d.pdb" target="_blank">Download CZP1 (pdb file we&#x27;ve been using PDB: 3IUT)</a></p>
<p>Once downloaded, the raw crystallographic structures can be processed by TidyScreen using the <code>process_raw_pdb()</code> function from the <code>MolDock</code> class as follows:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tidyscreen </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> tidyscreen </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> tidyscreen</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">moldock </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> moldock </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#### Activate the project. We will assume that a project &#x27;sample_project&#x27; has been created</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sample_project </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ActivateProject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;sample_project&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## Activate the MolDock dimension to process the receptor models</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sample_project_moldock </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> md</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">MolDock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sample_project</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Process the raw pdb file to generate the receptor mol2 and pdqbt files  ##JUAMPI##: pdbqt files with prepare_receptor4.py?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">czp_rx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/PATH/TO/PDB/FILE/2OZ2.pdb&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">catl_rx</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/PATH/TO/PDB/FILE/8hfv_aligned.pdb&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sample_project_moldock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">process_raw_pdb</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">czp_rx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> x_coord</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">6.7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_coord</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">3.7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> z_coord</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">22.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> x_points</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">40</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_points</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">40</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> z_points</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">40</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Upon execution this method, a couple of checkings and questions will be presented:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Outputs:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> MolDock dimension activated</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Please provide a brief description to store </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> the receptor model</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># enter the info that will be stored to a &#x27;description.txt&#x27; file in the receptor folder</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Chains detected</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;C&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;A&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># The presence of multi chains is performed and informed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Provide the chain identifier to mantain</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;all&quot;</span><span class="token plain"> to keep </span><span class="token builtin">all</span><span class="token plain"> chains</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Enter the chain to extract, in this example we will use chain &quot;A&quot; </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Non</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">standard residues detected</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> The following non</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">standard residues were found </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> the pdb </span><span class="token builtin">file</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;D1R&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;SO4&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> Do you want to mantain ONE of them </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> the processed receptor pdb </span><span class="token builtin">file</span><span class="token plain">? </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">y</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># We don&#x27;t want to include non standard residues as part of the receptor, so just indicate &#x27;n&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> The following non</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">standard residues were found </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> the pdb </span><span class="token builtin">file</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;D1R&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;SO4&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> Do you want to mantain ONE of them </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> a REFERENCE pdb </span><span class="token builtin">file</span><span class="token plain">? </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">y</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># We would like to save a reference .pdb file containing the D1R to evaluate docking assays, so indicate &#x27;y&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Type the </span><span class="token number" style="color:#36acaa">3</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">letter code of the residue you want to save </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> REFERENCE FILE</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Type D1R to select the residue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## The system should inform the successful processing of the receptor.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>After the above process has been completed, a folder within <code>$PATH/TO/PROJECT/docking/raw_data</code> should have been created containing the prepared receptor folder (2OZ2)
##JUAMPI##: Which files are generated? Is the .gpf included? It&#x27;d be nice to give a short explanation of the output!</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="112-autodock4-grids-generation">1.1.2. AutoDock4 grids generation<a href="#112-autodock4-grids-generation" class="hash-link" aria-label="Direct link to 1.1.2. AutoDock4 grids generation" title="Direct link to 1.1.2. AutoDock4 grids generation">​</a></h4>
<p>Define a grid box centered on the crystallographic ligand (A-site) and generate AutoGrid maps for AutoDock4.</p>
<p>With the grid parameter file prepared, the next step is to run <strong>AutoGrid</strong>.<br>
<!-- -->This program uses the receptor and the defined grid box to generate the energy maps required by AutoDock4.<br>
<!-- -->These maps describe the interaction potentials of the ligand atom types within the receptor binding site and are essential for the subsequent docking step.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">autogrid4 -p 2OZ2.gpf</span><br></span></code></pre></div></div>
<p>After completion, AutoGrid will produce:</p>
<ul>
<li>
<p>One .map file per ligand atom type (e.g.: <code>2OZ2.C.map</code>, <code>2OZ2.HD.map</code>, <code>2OZ2.N.map</code>, <code>2OZ2.NA.map</code>, <code>2OZ2.OA.map</code>, etc.)</p>
</li>
<li>
<p>One .map file for electrostatic and desolvation energies (i.e.: <code>2OZ2.d.map</code>, <code>2OZ2.e.map</code>).</p>
</li>
<li>
<p>A .fld file (<code>2OZ2.maps.fld</code>) that collects all maps.</p>
</li>
</ul>
<p>Up to this point, we should possess all the necessary information about the receptors to conduct the docking studies.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-ligand-preparation-k777">1.2. Ligand preparation: K777<a href="#12-ligand-preparation-k777" class="hash-link" aria-label="Direct link to 1.2. Ligand preparation: K777" title="Direct link to 1.2. Ligand preparation: K777">​</a></h3>
<p>In order to replicate the crystal structure, we will run docking studies with K777 and the receptors we just parametrized.</p>
<p>To do that, in the <code>$PATH/chemspace/raw_data/</code> create a file called <code>K777.csv</code> containing the SMILES of the ligand.</p>
<div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">K777.csv</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token constant" style="color:#36acaa">O</span><span class="token operator" style="color:#393A34">=</span><span class="token constant" style="color:#36acaa">S</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">C1</span><span class="token operator" style="color:#393A34">=</span><span class="token constant" style="color:#36acaa">CC</span><span class="token operator" style="color:#393A34">=</span><span class="token constant" style="color:#36acaa">CC</span><span class="token operator" style="color:#393A34">=</span><span class="token constant" style="color:#36acaa">C1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">/</span><span class="token constant" style="color:#36acaa">C</span><span class="token operator" style="color:#393A34">=</span><span class="token constant" style="color:#36acaa">C</span><span class="token operator" style="color:#393A34">/</span><span class="token punctuation" style="color:#393A34">[</span><span class="token constant" style="color:#36acaa">C</span><span class="token plain">@</span><span class="token constant" style="color:#36acaa">H</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">CCC2</span><span class="token operator" style="color:#393A34">=</span><span class="token constant" style="color:#36acaa">CC</span><span class="token operator" style="color:#393A34">=</span><span class="token constant" style="color:#36acaa">CC</span><span class="token operator" style="color:#393A34">=</span><span class="token constant" style="color:#36acaa">C2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token constant" style="color:#36acaa">NC</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token constant" style="color:#36acaa">C</span><span class="token plain">@</span><span class="token constant" style="color:#36acaa">H</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">CC3</span><span class="token operator" style="color:#393A34">=</span><span class="token constant" style="color:#36acaa">CC</span><span class="token operator" style="color:#393A34">=</span><span class="token constant" style="color:#36acaa">CC</span><span class="token operator" style="color:#393A34">=</span><span class="token constant" style="color:#36acaa">C3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token constant" style="color:#36acaa">NC</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">N4CCN</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">C</span><span class="token punctuation" style="color:#393A34">)</span><span class="token constant" style="color:#36acaa">CC4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">=</span><span class="token constant" style="color:#36acaa">O</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">=</span><span class="token constant" style="color:#36acaa">O</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">=</span><span class="token constant" style="color:#36acaa">O</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">K777</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">5</span><br></span></code></pre></div></div>
<p>Then, activate the chemspace module within <code>Workshop.py</code>.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Activate the ChemSpace section of the project</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Workshop_chemspace </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> chemspace</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ChemSpace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Workshop</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Import the .csv file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Workshop_chemspace</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">input_csv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;$PATH/chemspace/raw_data/K777.csv&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>After preparing the receptor, the next step is to generate the <strong>ligand files</strong> required for docking.<br>
<!-- -->Specifically, we need to obtain the <code>.pdbqt</code> formats for AutoDock.<br>
<!-- -->Since these molecules may also be subjected to <strong>molecular dynamics simulations</strong> later on, we will additionally generate <code>.mol2</code> and <code>.frcmod</code> files.</p>
<p>Atomic charges are assigned using <code>prepare_ligand4.py</code> by default, but different charges can be set.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Parametrization</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Workshop_chemspace</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">generate_mols_in_table</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;K777&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1000000</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>At this stage, all the necessary input files have been prepared, and we are ready to proceed with the docking study.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="13-first-docking-validation">1.3. First docking validation<a href="#13-first-docking-validation" class="hash-link" aria-label="Direct link to 1.3. First docking validation" title="Direct link to 1.3. First docking validation">​</a></h3>
<p>In order to validate our docking protocol, the first step is to compare the predicted binding pose with the crystallographic reference to evaluate whether the chosen docking parameters (grid size, spacing, scoring function, and search algorithm) are able to reproduce the native interaction mode. A successful docking provides confidence that the protocol is suitable to be extended to other congeners and to virtual screening campaigns.</p>
<p>To proceed, we first activate the <code>moldock</code> module from <em>TidyScreen</em> and register the prepared receptor by creating a database entry that points to the target files (<code>.map</code> grids, <code>.pdbqt</code>, <code>.fld</code>, and reference <code>.pdb</code>).</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Initialize MolDock</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Workshop_docking </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> moldock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">MolDock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Workshop</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Register the receptor in the database, indicating the path to the folder containing the receptor/grid files.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Workshop_docking</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">input_receptor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;$PATH/TO/PROJECT/docking/raw_data/2OZ2&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>📝 Receptor description</div><div class="admonitionContent_BuS1"><p>When prompted, you will need to provide a short <strong>description of the receptor</strong>.<br>
<!-- -->Try to include as many relevant details as possible, such as:</p><ul>
<li>PDB ID</li>
<li>Preprocessing (waters/ions removed, protonation state)</li>
<li>Grid setup (center, npts, spacing)</li>
<li>Any special considerations (e.g. retained Mg²⁺)</li>
</ul><p>This information will be very useful in the future, especially when your database grows and you manage multiple receptor models.</p></div></div>
<p>Before running the docking experiment, it is necessary to define the docking parameters.<br>
<!-- -->The function <code>create_docking_params_set()</code> generates a database (<code>docking/params/docking_params.db</code>) containing the <strong>default AutoDock conditions</strong>.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Workshop_docking</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">create_docking_params_set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>Once the default set has been created, you may duplicate and customize the conditions to better suit your study.
For example, you can increase the number of docking runs from 20 to 100 (<em>--nrun=100</em>) or enable AutoDock to identify and report ligand–receptor interactions for each pose (<em>--contact_analysis=1</em>).</p>
<p>Now we can launch the docking experiment with the <code>dock_table()</code> function.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>📝 AutoDock</div><div class="admonitionContent_BuS1"><p>TidyScreen prepares all required input files and executes the docking through AutoDock-GPU, the GPU-accelerated implementation of AutoDock4. This allows a substantial speed-up compared to the CPU version, while maintaining compatibility with the same scoring function and parameter set.</p></div></div>
<p>You must define 3 variables:</p>
<ul>
<li><em>table_name</em>: name of the table containing the ligand(s) you want to use for the docking study, as stated in the <code>chemspace/processed_data/chemspace.db</code> database.</li>
<li><em>id_receptor_model</em>: ID of the target model you want to use for the docking study, as stated in the <code>docking/receptors/receptor.db</code> database.</li>
<li><em>id_docking_params</em>: ID of the docking conditions you want to apply for the study, as stated in the <code>docking/params/docking_params.db</code> database.</li>
</ul>
<p>Once again you will be asked to provide a brief <strong>description</strong> of the docking assay. Try to include as many relevant details as possible.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>📝 IDs</div><div class="admonitionContent_BuS1"><p>Make sure that the IDs (<em>id_receptor_model</em> and <em>id_docking_params</em>) correspond to the entries you created earlier.
If in doubt, you can query the databases to list available IDs before running the docking.</p></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Workshop_docking</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dock_table</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">table_name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;K777&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> id_receptor_model</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> id_docking_params</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>After running <code>dock_table()</code>, <em>TidyScreen</em> will:</p>
<ul>
<li>Create a summary entry of the assay (variables + description) in <code>docking/docking_registers/docking_registers.db</code>.</li>
<li>Create a new assay folder under <code>docking/docking_assays/assay_&lt;ASSAY_ID&gt;</code> containing:<!-- -->
<ul>
<li><em>receptor/</em> and <em>ligands/</em> subfolders with all input files,</li>
<li>a ready-to-run execution script: <code>docking_execution.sh</code>.</li>
</ul>
</li>
</ul>
<p>You can launch the assay in your terminal with:</p>
<div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">docking_execution</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">sh</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="14-inspecting-autodock-outputs">1.4. Inspecting AutoDock outputs<a href="#14-inspecting-autodock-outputs" class="hash-link" aria-label="Direct link to 1.4. Inspecting AutoDock outputs" title="Direct link to 1.4. Inspecting AutoDock outputs">​</a></h3>
<p>After execution, AutoDock produces a <em>docking log</em> (<code>.dlg</code>) for each ligand under: <code>docking/docking_assays/assay_&lt;ASSAY_ID&gt;/dlgs/</code>.</p>
<p>Each <code>.dlg</code> file <strong>summarizes</strong>:</p>
<ul>
<li>the predicted <strong>poses</strong> (coordinates),</li>
<li>the <strong>interaction report</strong> per pose (if <code>--contact_analysis=1</code>),</li>
<li>the <strong>docking score</strong> (binding energy) of each conformation,</li>
<li>and a <strong>cluster size summary</strong> at the end of the file.</li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>📝 Cluster size</div><div class="admonitionContent_BuS1"><p>The cluster size indicates how many independent runs converged to (approximately) the <strong>same pose</strong>.<br>
<!-- -->For example, if <code>--nrun=100</code> and a cluster reports <code>size = 80</code>, it means <strong>80/100</strong> runs found that pose as the best (lowest energy) within that cluster. Larger clusters often suggest <strong>higher pose stability/reproducibility</strong> under the search settings.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="15-docking-analyses">1.5. Docking analyses<a href="#15-docking-analyses" class="hash-link" aria-label="Direct link to 1.5. Docking analyses" title="Direct link to 1.5. Docking analyses">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="151-autodock-output">1.5.1. Autodock output<a href="#151-autodock-output" class="hash-link" aria-label="Direct link to 1.5.1. Autodock output" title="Direct link to 1.5.1. Autodock output">​</a></h4>
<p>In this first example, analysing the <code>.dlg</code> file and the docked poses is relatively straightforward, since the study involved only a single ligand. However, when working with larger ligand sets, manual inspection quickly becomes impractical.  For this reason, <em>TidyScreen</em> provides a <code>DockingAnalysis</code> module and a <code>process_docking_assay()</code> function to automate the post-processing of docking results.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Important</div><div class="admonitionContent_BuS1"><p>When activating the <code>DockingAnalysis</code> module, you can specify the path to <strong>AMBER</strong> (via <code>amberhome</code>) and <strong>VMD</strong>.<br>
<!-- -->This way, the program will automatically use this path during the analyses, instead of prompting you for it every time you run a single analysis.</p></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">#Activate the module</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Workshop_docking_analysis </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> docking_analysis</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DockingAnalysis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Workshop</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> amberhome</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;/PATH/TO/AMBER/amber&lt;VERSION&gt;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vmd_path</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;PATH/TO/VMD&quot;</span><br></span></code></pre></div></div>
<p>The <code>process_docking_assay()</code> function parses the AutoDock outputs of a given assay, leveraging the <a href="https://ringtail.readthedocs.io/en/latest/" target="_blank" rel="noopener noreferrer">Ringtail</a> library to efficiently handle the results. It ranks the poses by docking score (most negative = best) and stores the selected results for downstream analysis.</p>
<p>You should define the following variables:</p>
<ul>
<li><em>assay_id</em> (int, required): ID of the docking assay to analyze (as registered by dock_table()).</li>
<li><em>max_poses</em> (int, default = 10): Maximum number of poses per ligand to store in the results database, ordered from best (lowest binding energy) to worse.</li>
<li><em>vmd_path</em> (str | None, default = None): Path to VMD (Visual Molecular Dynamics). If provided, helper files/commands for quick visualization are prepared.</li>
<li><em>extract_poses</em> (int [0,1], default = 0): If 1, writes PDB files for each selected pose. If 0, keeps only the database records and existing PDBQT/DLG outputs.</li>
</ul>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">#Set and run the docking analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Workshop_docking_analysis</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">process_docking_assay</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">assay_id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> max_poses</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vmd_path</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">vmd_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> extract_poses</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>As a result, a new database <code>assay_&lt;ID&gt;.db</code>  will be generated inside the corresponding assay docking folder.</p>
<p>This file contains several tables that organize the results of the analysis:</p>
<ul>
<li>
<p><em>interaction_indices</em>: dictionary of interaction types (e.g., hydrogen bonds H and van der Waals V) that can be identified between ligands and receptor.</p>
</li>
<li>
<p><em>interactions</em>: records which interactions were detected for each docked pose of every ligand.</p>
</li>
<li>
<p><em>ligands</em>: stores ligand-specific data and a summary of their detected interactions.</p>
</li>
<li>
<p><em>receptor</em>: summary information of the target used in the assay.</p>
</li>
<li>
<p><em>Results</em>: pose-level data extracted from the .dlg file, including binding energies, cluster ranks, and other docking details.</p>
</li>
</ul>
<p>If <em>extract_poses=1</em>, a new subfolder <em>docked_1_per_cluster/</em> will be created inside the assay folder, containing the PDB files of the top docked poses (one representative per cluster) for each ligand, making it easier to visualize and compare binding modes.</p>
<p>##JUAMPI## Analyze scores and cluster sizes? Calculate rmsd? Visualize poses vs. crystallographic structure?</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="152-computing-interaction-fingerprints-for-a-docked-pose">1.5.2. Computing interaction fingerprints for a docked pose<a href="#152-computing-interaction-fingerprints-for-a-docked-pose" class="hash-link" aria-label="Direct link to 1.5.2. Computing interaction fingerprints for a docked pose" title="Direct link to 1.5.2. Computing interaction fingerprints for a docked pose">​</a></h4>
<p>The function <code>compute_fingerprints_for_docked_pose()</code> automates the post-processing of <strong>one specific docked pose</strong>, generating:</p>
<ul>
<li>per-residue <strong>ProLIF</strong> interaction fingerprints (binary interaction features),</li>
<li>per-residue <strong>MMGBSA</strong> interaction fingerprints (AMBER MMPBSA decomposition).</li>
</ul>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Workshop_docking_analysis</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">compute_fingerprints_for_docked_pose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    assay_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    results_pose_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mmgbsa</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    prolif</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    clean_files</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    clean_folder</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    solvent</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;implicit&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    min_steps</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">5000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    store_docked_poses</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    prolif_parameters_set</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    iteration</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ligresname</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;UNL&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p><strong>Parameters</strong></p>
<ul>
<li>
<p><em>assay_id</em> (int, required): ID of the docking assay containing the pose.</p>
</li>
<li>
<p><em>results_pose_id</em> (int, required): ID of the pose to analyze (from the assay database results, e.g.: assay_X.pdb).</p>
</li>
<li>
<p><em>mmgbsa</em> (0/1, default=1): compute (1) or not (0) MMGBSA per-residue decomposition for the pose.</p>
</li>
<li>
<p><em>prolif</em> (0/1, default=1): compute (1) or not (0) ProLIF interaction fingerprint for the pose.</p>
</li>
<li>
<p><em>clean_files</em> (0/1, default=1): remove (1) or not (0) temporary files generated by MMPBSA/LEaP after finishing.</p>
</li>
<li>
<p><em>clean_folder</em> (0/1, default=1): remove (1) or not (0) the whole fingerprints_analyses/working folder after storing outputs.</p>
</li>
<li>
<p><em>solvent</em> (<!-- -->explicit<!-- -->, default=&quot;implicit&quot;): solvent model used during minimization/prep for fingerprints.</p>
</li>
<li>
<p><em>min_steps</em> (int, default=5000): minimization steps for preparing the complex prior to fingerprints.</p>
</li>
<li>
<p><em>store_docked_poses</em> (0/1, default=1): store (1) or not (0) the docked pose in the results DB.</p>
</li>
<li>
<p><em>prolif_parameters_set</em> (int, default=1): ID of the parameter set in docking/params/prolif_parameters.db.</p>
</li>
<li>
<p><em>iteration</em> (int, default=1): if 1, builds a residue-mapping dictionary (crystal vs tleap) and saves it; otherwise reuses it.</p>
</li>
<li>
<p><em>ligresname</em> (str, default=&quot;UNL&quot;): residue name used for the ligand in the complex (needed by LEaP/MMPBSA).</p>
</li>
</ul>
<p>🤔 <strong>What does the function do?</strong></p>
<p><strong>i)</strong> Sets up a working directory under <em>docking/docking_assays/assay_<code>&lt;ID&gt;</code>/fingerprints_analyses/<code>&lt;pose_subfolder&gt;</code>/</em>.</p>
<p><strong>ii)</strong> If <em>mmgbsa == 1</em>, prepares AMBER input (LEaP), minimizes the complex (min_steps, solvent), runs MMPBSA decomposition and writes a per-residue CSV, and stores the results in the DB (<em>store_mmbgsa_fingerprints_results_in_db</em>).</p>
<p><strong>iii)</strong> If <em>prolif == 1</em>, builds a reference ProLIF dataframe for the entire receptor, mapped to the crystallographic numbering. It reuses the minimized prmtop/crd files if <em>mmgbsa == 1</em>; otherwise, these files are generated specifically for the ProLIF computation. Then, it retrieves the parameter set from <em>docking/params/prolif_parameters.db</em> according to the prolif_parameters_set ID, computes the ProLIF fingerprint for the docked pose and maps it to the crystallographic residue numbering, and saves the results as <em>prolif_fingerprints_renum.csv</em> and registers them in the database.</p>
<p><strong>iv)</strong> If <em>store_docked_poses == 1</em>, the pose itself is stored in the results database.</p>
<p><strong>v)</strong> Depending on the values of clean_files and clean_folder, the function will also remove intermediate files and/or the entire workspace once the computations are complete.</p>
<p><strong>vi)</strong> Finally, the total execution time is logged and printed to the console.</p>
<p>As a practical example, we will calculate the interaction fingerprint of <em>Gentamicin C1a docked pose 1</em>, in order to evaluate whether the interactions identified experimentally can also be reproduced <em>in silico</em>. For simplicity, we will use the <em>default conditions</em> of the function.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Workshop_docking_analysis</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">compute_fingerprints_for_docked_pose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">assay_id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> results_pose_id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1521-interaction-fingerprints-with-prolif">1.5.2.1. Interaction fingerprints with ProLIF<a href="#1521-interaction-fingerprints-with-prolif" class="hash-link" aria-label="Direct link to 1.5.2.1. Interaction fingerprints with ProLIF" title="Direct link to 1.5.2.1. Interaction fingerprints with ProLIF">​</a></h4>
<p><a href="https://prolif.readthedocs.io/en/latest/" target="_blank" rel="noopener noreferrer">ProLIF</a> is a Python library that encodes <strong>target–ligand interactions</strong> into machine-readable fingerprints.<br>
<!-- -->For each residue, it records whether specific interaction types were detected with the ligand in a given pose.</p>
<p><strong>What information does it provide?</strong><br>
<!-- -->Each column of the output corresponds to a residue–interaction pair, for example:</p>
<ul>
<li><code>GLN19_A_HBDonor</code> → hydrogen bond donor detected between residue Glutamine 19 of CZP and the ligand.</li>
<li><code>TRP184_A_PiStacking</code> → π–π stacking between residue Tryptophan 184 of CZP and the ligand.</li>
<li><code>MET145_A_VdWContact</code> → van der Waals contact between Methionine 145 of CZP and the ligand.</li>
</ul>
<p>Values are binary (0 or 1), indicating the <strong>presence (1)</strong> or <strong>absence (0)</strong> of the interaction in a given pose.<br>
<!-- -->This way, each pose can be represented as a vector of interactions, allowing systematic comparisons between poses or ligands.</p>
<p><strong>How to analyze it?</strong></p>
<ul>
<li>At the <strong>single-pose level</strong>, you can identify which key interactions (e.g., H-bonds, hydrophobic contacts) stabilize the binding mode.</li>
<li>At the <strong>comparative level</strong>, you can check whether the best-scoring poses reproduce the same interactions observed in the crystallographic structure (e.g., conserved H-bonds in the A-site).</li>
<li>At the <strong>dataset level</strong>, these fingerprints can be clustered or used as features in <strong>QSAR/ML models</strong> to link interaction patterns with biological activity.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1522-interaction-fingerprints-with-mmgbsa">1.5.2.2. Interaction fingerprints with MMGBSA<a href="#1522-interaction-fingerprints-with-mmgbsa" class="hash-link" aria-label="Direct link to 1.5.2.2. Interaction fingerprints with MMGBSA" title="Direct link to 1.5.2.2. Interaction fingerprints with MMGBSA">​</a></h4>
<p>In addition to ProLIF, <em>TidyScreen</em> provides the option to minimize the docked pose of interest and evaluate the energetic contribution of each residue to the complex stabilization through <strong>MMGBSA per-residue decomposition</strong>. This approach not only reveals which contacts are present, but also quantifies how favorable or unfavorable each interaction is. Furthermore, it allows the calculation of the overall <strong>Effective Binding Energy (EBE)</strong> of the complex. While docking scores are useful for ranking poses, MMGBSA provides a more physically grounded estimation of binding affinity, often better correlated with experimental data.</p>
<p>By setting <code>mmgbsa = 1</code> in the <code>compute_fingerprints_for_docked_pose()</code> function, a file named <code>mmgbsa_DECOMP_renum.csv</code> is generated, and a new <code>mmgbsa_fingerprints</code> table is added to the <code>assay_&lt;ID&gt;.db</code> database.</p>
<p>##JUAMPI## Is there any function to plot and/or analyze the results easily? Or should we provide scripts for that? (e.g.: heatmaps)</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="16-molecular-dynamics">1.6. Molecular Dynamics?<a href="#16-molecular-dynamics" class="hash-link" aria-label="Direct link to 1.6. Molecular Dynamics?" title="Direct link to 1.6. Molecular Dynamics?">​</a></h3>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-training-set">2. Training set<a href="#2-training-set" class="hash-link" aria-label="Direct link to 2. Training set" title="Direct link to 2. Training set">​</a></h2></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/examples/LA_Workshop.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-replication-of-the-crystallographic-binding-mode-of-k777" class="table-of-contents__link toc-highlight">1. Replication of the crystallographic binding mode of K777</a><ul><li><a href="#11-receptor-preparation" class="table-of-contents__link toc-highlight">1.1. Receptor preparation</a></li><li><a href="#12-ligand-preparation-k777" class="table-of-contents__link toc-highlight">1.2. Ligand preparation: K777</a></li><li><a href="#13-first-docking-validation" class="table-of-contents__link toc-highlight">1.3. First docking validation</a></li><li><a href="#14-inspecting-autodock-outputs" class="table-of-contents__link toc-highlight">1.4. Inspecting AutoDock outputs</a></li><li><a href="#15-docking-analyses" class="table-of-contents__link toc-highlight">1.5. Docking analyses</a></li><li><a href="#16-molecular-dynamics" class="table-of-contents__link toc-highlight">1.6. Molecular Dynamics?</a></li></ul></li><li><a href="#2-training-set" class="table-of-contents__link toc-highlight">2. Training set</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/TidyScreen_v2_docs_new/docs/documentation_index">Documentation</a></li><li class="footer__item"><a class="footer__link-item" href="/TidyScreen_v2_docs_new/docs/contact">Contact</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">MedChemLab - Faculty of Chemical Sciences, National University of Córdoba, Argentina. 2025.</div></div></div></footer></div>
</body>
</html>