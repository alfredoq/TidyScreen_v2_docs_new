<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-examples/LA_Workshop/exploring_chemical_space" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">5. Chemical space design and vHTS workflow | TidyScreen</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://alfredoq.github.io/TidyScreen_v2_docs_new/img/tidyscreen_logo.png"><meta data-rh="true" name="twitter:image" content="https://alfredoq.github.io/TidyScreen_v2_docs_new/img/tidyscreen_logo.png"><meta data-rh="true" property="og:url" content="https://alfredoq.github.io/TidyScreen_v2_docs_new/docs/examples/LA_Workshop/exploring_chemical_space"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="5. Chemical space design and vHTS workflow | TidyScreen"><meta data-rh="true" name="description" content="In this final section, we will extend the previously validated docking methodology to generate and evaluate new triazole-based Targeted Covalent Inhibitors (TCIs) of Cruzipain (CZP)."><meta data-rh="true" property="og:description" content="In this final section, we will extend the previously validated docking methodology to generate and evaluate new triazole-based Targeted Covalent Inhibitors (TCIs) of Cruzipain (CZP)."><link data-rh="true" rel="icon" href="/TidyScreen_v2_docs_new/img/tidyscreen_logo.png"><link data-rh="true" rel="canonical" href="https://alfredoq.github.io/TidyScreen_v2_docs_new/docs/examples/LA_Workshop/exploring_chemical_space"><link data-rh="true" rel="alternate" href="https://alfredoq.github.io/TidyScreen_v2_docs_new/docs/examples/LA_Workshop/exploring_chemical_space" hreflang="en"><link data-rh="true" rel="alternate" href="https://alfredoq.github.io/TidyScreen_v2_docs_new/docs/examples/LA_Workshop/exploring_chemical_space" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"5. Chemical space design and vHTS workflow","item":"https://alfredoq.github.io/TidyScreen_v2_docs_new/docs/examples/LA_Workshop/exploring_chemical_space"}]}</script><link rel="alternate" type="application/rss+xml" href="/TidyScreen_v2_docs_new/blog/rss.xml" title="TidyScreen RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/TidyScreen_v2_docs_new/blog/atom.xml" title="TidyScreen Atom Feed"><link rel="stylesheet" href="/TidyScreen_v2_docs_new/assets/css/styles.f7cb7648.css">
<script src="/TidyScreen_v2_docs_new/assets/js/runtime~main.bfa1898d.js" defer="defer"></script>
<script src="/TidyScreen_v2_docs_new/assets/js/main.a421c380.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/TidyScreen_v2_docs_new/img/tidyscreen_logo.png"><link rel="preload" as="image" href="/TidyScreen_v2_docs_new/img/Synthetic_Scheme_Whorkshop.png"><link rel="preload" as="image" href="/TidyScreen_v2_docs_new/img/CUFNDGFOXHNKKU-MGUYBSQASA-O.png"><link rel="preload" as="image" href="/TidyScreen_v2_docs_new/img/CYWLRULGWUKHND-QDRCWIAMSA-O.png"><link rel="preload" as="image" href="/TidyScreen_v2_docs_new/img/CYWLRULGWUKHND-QDRCWIAMSA-O-CZP.png"><link rel="preload" as="image" href="/TidyScreen_v2_docs_new/img/CYWLRULGWUKHND-QDRCWIAMSA-O-CatL.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/TidyScreen_v2_docs_new/"><div class="navbar__logo"><img src="/TidyScreen_v2_docs_new/img/tidyscreen_logo.png" alt="TidyScreen" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/TidyScreen_v2_docs_new/img/tidyscreen_logo.png" alt="TidyScreen" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">HomePage</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/TidyScreen_v2_docs_new/docs/project_overview">Documentation</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/TidyScreen_v2_docs_new/docs/project_overview">Overview of the project</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/TidyScreen_v2_docs_new/docs/installation">Installation and Dependencies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/TidyScreen_v2_docs_new/docs/information_flow">Information flow</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/TidyScreen_v2_docs_new/docs/chemspace/compounds_input">ChemSpace</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/TidyScreen_v2_docs_new/docs/chemspace_analysis/">ChemSpace Analysis</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/TidyScreen_v2_docs_new/docs/template_page">MolDock</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/TidyScreen_v2_docs_new/docs/template_page">MolDock Analysis</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/TidyScreen_v2_docs_new/docs/template_page">MolDyn</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/TidyScreen_v2_docs_new/docs/template_page">MolDyn Analysis</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/TidyScreen_v2_docs_new/docs/examples/chemical_space_synthesis">Tutorials</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/TidyScreen_v2_docs_new/docs/examples/chemical_space_synthesis">Chemical space synthesis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/TidyScreen_v2_docs_new/docs/examples/docking">Molecular Docking studies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/TidyScreen_v2_docs_new/docs/examples/ersilia_on_table">Integration with Ersilia Hub Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/TidyScreen_v2_docs_new/docs/examples/molecules_preparation">Molecules preparation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/TidyScreen_v2_docs_new/docs/examples/LA_Workshop/design_of_TCIs_targeting_CZP">LA Workshop 2025</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TidyScreen_v2_docs_new/docs/examples/LA_Workshop/design_of_TCIs_targeting_CZP">1. Design of Targeted Covalent Inhibitors (TCIs) targeting Cruzipain</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TidyScreen_v2_docs_new/docs/examples/LA_Workshop/introduction">2. Introduction to TidyScreen projects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TidyScreen_v2_docs_new/docs/examples/LA_Workshop/modeling_CZP_hCATl_binders">3. Receptor modeling and validation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TidyScreen_v2_docs_new/docs/examples/LA_Workshop/modeling_a_training_set">4. Evaluation of a training set</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/TidyScreen_v2_docs_new/docs/examples/LA_Workshop/exploring_chemical_space">5. Chemical space design and vHTS workflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TidyScreen_v2_docs_new/docs/examples/LA_Workshop/conclusions">6. Key Takeaways</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/TidyScreen_v2_docs_new/docs/contact">Contact</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/TidyScreen_v2_docs_new/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Tutorials</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">LA Workshop 2025</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">5. Chemical space design and vHTS workflow</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Chemical Space Design and vHTS Workflow</h1></header>
<div style="text-align:justify"><p>In this final section, we will extend the previously validated docking methodology to generate and evaluate <strong>new triazole-based Targeted Covalent Inhibitors (TCIs)</strong> of Cruzipain (CZP).</p><p>Following the successful validation of the docking workflow using a training set of triazole-containing derivatives featuring a methyleneamine linker as bioisosteric replacements of peptide bonds and the well-known efficacy of the vinylsulfone-containing inhibitor <strong>K777</strong>, our goal is to design a new series of molecules that <strong>combine these three structural elements</strong>.</p><p>Given the absence of reported analogues combining these motifs, we will perform a massive virtual library generation and screening campaign aimed at identifying candidates with <strong>high affinity for CZP</strong> and <strong>minimal affinity for hCatL</strong>, while ensuring <strong>synthetic feasibility</strong> for subsequent <em>wet-lab</em> validation.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview-of-the-protocol">Overview of the Protocol<a href="#overview-of-the-protocol" class="hash-link" aria-label="Direct link to Overview of the Protocol" title="Direct link to Overview of the Protocol">‚Äã</a></h2><p>The overall workflow can be divided into five major steps:</p><p><strong>5.1- Extraction of building blocks</strong><br>
<!-- -->Retrieve potential reactants from the <em>eMolecules</em> chemical database.</p><p><strong>5.2- Chemical space reduction</strong><br>
<!-- -->Filter the combinatorial chemical space based on:</p><ul>
<li><em>Drug-likeness</em> criteria</li>
<li><em>Synthetic feasibility</em></li>
<li><em>Affordability</em>, using models provided through <strong>Ersilia Hub</strong>.</li>
</ul><p><strong>5.3- In silico synthesis of derivatives</strong><br>
<!-- -->Combine the selected reactants through feasible <em>in silico</em> synthetic routes to generate the final compounds, replicating realistic reactions that can be performed in the wet lab.</p><p><strong>5.4- Toxicity filtering</strong><br>
<!-- -->Further reduce the library by eliminating potentially hepatotoxic molecules, applying an <strong>Ersilia Hub DILI prediction model</strong>.</p><p><strong>5.5- Docking and analysis</strong><br>
<!-- -->Perform docking-based <em>vHTS</em> on the safest and most promising analogues (approximately <strong>5000 compounds</strong>) and analyze their predicted affinity and selectivity profiles toward CZP and hCatL.</p><hr><p>üéØ This will allow prioritization of candidates for <em>in vitro</em> and <em>in vivo</em> validation, completing the <em>dry</em>-to-<em>wet lab</em> pipeline proposed in this tutorial.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="51--extraction-of-building-blocks">5.1- <strong>Extraction of building blocks</strong><a href="#51--extraction-of-building-blocks" class="hash-link" aria-label="Direct link to 51--extraction-of-building-blocks" title="Direct link to 51--extraction-of-building-blocks">‚Äã</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="-synthetic-plan">üß≠ Synthetic plan<a href="#-synthetic-plan" class="hash-link" aria-label="Direct link to üß≠ Synthetic plan" title="Direct link to üß≠ Synthetic plan">‚Äã</a></h4><p>We will combine three independently tractable substituents (<strong>R<sup>1</sup></strong>, <strong>R<sup>2</sup></strong>, <strong>R<sup>3</sup></strong>) on a common scaffold through a concise, wet-lab-ready sequence:</p><p><em>i.)</em> <strong>R<sup>1</sup></strong> will be introduced from commercial <strong>amino acids</strong>, which will be derivatized to the corresponding <strong>azides</strong> by means of <em>diazotransfer</em> reactions.</p><p><em>ii.)</em> <strong>R<sup>2</sup></strong> and <strong>R<sup>3</sup></strong> will be derived from <strong>aldehyde</strong> and <strong>methyleneamine</strong> derivatives, respectively, which will be combined via <em>A3 coupling</em> to obtain <strong>propargylamine</strong> intermediates.</p><p><em>iii.)</em> The azides and alkynes obtained from (i) and (ii) will be joined through <em>CuAAC</em> to yield <strong>1,4-disubstituted 1,2,3-triazole</strong> derivatives.</p><p><em>iv.)</em> Finally, to introduce the <strong>phenyl-vinylsulfone warhead (WH)</strong>, a <em>Horner-Wadsworth-Emmons (HWE) olefination</em> will be replicated <em>in silico</em>.</p><hr><p>Thus, we will generate lists of potential <strong>reactants</strong> - namely <strong>amino acids</strong>, <strong>aldehydes</strong>, and <strong>methyleneamines</strong> - that can be purchased and used as starting points for the <em>in silico</em> synthesis.<br>
<!-- -->To this purpose, we will filter compounds from the <strong>eMolecules</strong> database. This will ensure that all designed structures are <strong>synthetically feasible and accessible</strong> for <em>wet-lab</em> validation.</p><div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>üìù About eMolecules</div><div class="admonitionContent_BuS1"><p><strong><a href="https://www.emolecules.com/" target="_blank" rel="noopener noreferrer">eMolecules</a></strong> is a large supplier-aggregated catalog of <strong>purchasable reagents</strong> and <strong>make-on-demand</strong> building blocks. It was founded in 2005 with a vision to reduce drug discovery timelines through improved efficiencies in the compound search and acquisition process.</p></div></div><div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Important</div><div class="admonitionContent_BuS1"><p>Please check if the <em>chemspace module</em> is active within <code>workshop.py</code>.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> chemspace</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ChemSpace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">la_workshop</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="511--Ô∏è-import-emolecules-database">5.1.1- üóÇÔ∏è Import eMolecules database<a href="#511--Ô∏è-import-emolecules-database" class="hash-link" aria-label="Direct link to 5.1.1- üóÇÔ∏è Import eMolecules database" title="Direct link to 5.1.1- üóÇÔ∏è Import eMolecules database">‚Äã</a></h3><p>Import the chemical database file from <strong>eMolecules</strong> (usually stored in <code>chemspace/raw_data/</code>) into the local <strong>TidyScreen</strong> project database (<code>chemspace/processed_data/chemspace.db</code>).</p><p>This step converts the original <code>.csv</code> file into a structured SQLite database that can be efficiently queried by TidyScreen for compound selection and filtering.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">emolecules_database_file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/PATH/TO/FILE/emolecules.csv&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#Set your own path!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">input_csv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">emolecules_database_file</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="512---chemical-scaffolds-filtering">5.1.2- üß© Chemical scaffolds filtering<a href="#512---chemical-scaffolds-filtering" class="hash-link" aria-label="Direct link to 5.1.2- üß© Chemical scaffolds filtering" title="Direct link to 5.1.2- üß© Chemical scaffolds filtering">‚Äã</a></h3><p>To subset the types of compounds we need, <strong>TidyScreen</strong> uses chemical filters defined by <strong>SMARTS patterns</strong>.<br>
<!-- -->By default, a list of these filters is already included and can be inspected using the following function:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># List available SMARTS filters to obtain reactants</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">list_available_smarts_filters</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>You should get the following output:</p><p><code>Available SMARTS filters:</code><br>
<code>Filter_id: 1, Filter_Name: Aminoacids, SMARTS: [NX3H2,NX4+H3][CX4H]([*])[CX3H0](=[OX1])[OX2H,OX1-]</code><br>
<code>...</code><br>
<code>Filter_id: 10, Filter_Name: Aldehydes, SMARTS: [CX3H1](=O)[#6]</code><br>
<code>Filter_id: 11, Filter_Name: PrimAmines, SMARTS: [NX3;H2;!$(NC=O)]</code><br>
<code>Filter_id: 12, Filter_Name: SecAmines, SMARTS: [NX3;H1;!$(NC=O)]</code><br>
<code>...</code><br>
<code>Filter_id: 53, Filter_Name: sulfonamide, SMARTS: [SX4](=O)(=O)N</code></p><p>One of the classes of reactants we need corresponds to Œ±-amino acids (<code>Filter_id = 1</code>).
While it is possible to directly select all eMolecules entries containing at least one such group, this approach would be inefficient and chemically irrational. The output would likely include compounds with
multiple amino acid groups (unsuitable for diazotransfer), additional reactive functional groups interfering with subsequent steps, rare isotopes or heteroatoms uncommon in drug-like molecules, chemically unstable or undesirable moieties, etc.</p><p>To refine the chemical space, TidyScreen allows creating sequential filtering workflows combining multiple SMARTS rules.</p><p>The function <code>create_smarts_filters_workflow()</code> accepts a dictionary in the form:</p><p><code>{ filter_id : maximum_allowed_occurrences }</code></p><p>Each key-value pair defines how many times a particular substructure is permitted in a molecule (e.g., 1:1 means exactly one Œ±-amino acid group; 2:0 means exclude all boron-containing compounds).</p><p>In this example, we will filter molecules that:</p><ul>
<li>Contain exactly one Œ±-amino acid group (1:1)</li>
<li>Contain exactly one primary amine (11:1)</li>
<li>Contain exactly one carboxylic acid group (26:1)</li>
<li>Exclude molecules containing any of the following: Boron (2:0), Silicon (3:0), Azides (4:0), Terminal Alkynes (5:0), Deuterium (6:0), Tritium (7:0), <sup>13</sup>C (8:0), <sup>15</sup>N (9:0), Selenium (17:0), Amides (21:0), Thiols (25:0), Esters (35:0), Sulfonamides (53:0).</li>
</ul><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Create a custom filtering workflow for Œ±-amino acids</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">create_smarts_filters_workflow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">26</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">17</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">21</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">25</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">35</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">53</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>When prompted, you will need to provide a short <strong>description of the filter</strong> (i.e.: <em>&quot;Filtering of amino acids compatible with CuAAC-centered reaction scheme&quot;</em>).</p><p><code>Provide a description for the SMARTS filters workflow: </code></p><p>Once confirmed, the workflow is stored in the internal database.<br>
<!-- -->You can verify that it was correctly created using the <code>list_available_smarts_filters_workflows()</code> function:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># List all available SMARTS filtering workflows</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">list_available_smarts_filters_workflows</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p><em>Output</em>: <code>Workflow_id: 1, Filter_Specs: {&quot;1&quot;: 1, &quot;11&quot;: 1, &quot;26&quot;: 1, &quot;2&quot;: 0, &quot;3&quot;: 0, &quot;4&quot;: 0, &quot;5&quot;: 0, &quot;6&quot;: 0, &quot;7&quot;: 0, &quot;8&quot;: 0, &quot;9&quot;: 0, &quot;17&quot;: 0, &quot;21&quot;: 0, &quot;25&quot;: 0, &quot;35&quot;: 0, &quot;53&quot;: 0}, Description: Filtering of amino acids compatible with CuAAC-centered reaction scheme</code></p><p>Now we can apply the corresponding workflow to filter the desired building blocks using the function <code>subset_table_by_smarts_workflow()</code>.
You need to specify two parameters: <em>The table name</em> (as stored in the chemspace.db) and the <em>Workflow ID</em> to be applied.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Filter Œ±-amino acids</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">subset_table_by_smarts_workflow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;emolecules&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>When prompted, provide a short <strong>description of the subset</strong> (i.e.: <em>&quot;Amino acids for diazotransfer reaction&quot;</em>).</p><p><code>Enter a description for the subset:</code></p><p>A new table containing only the filtered compounds will be created in the <code>chemspace.db</code>. Each table follows the naming convention <code>emolecules_subset_X</code>, where &quot;X&quot; corresponds to the subset number (incremental per run), not to the Workflow ID. This ensures that your filtered set is stored as an independent subset, ready to be used for subsequent in silico synthesis steps.</p><p><code>Table &#x27;emolecules_subset_1&#x27; created in: &#x27;/PATH/TO/PROJECT/chemspace/processed_data/chemspace.db&#x27;</code><br>
<code>Succesfully subseted table: &#x27;emolecules&#x27; by SMARTS filters workflow with ID: &#x27;1&#x27;</code></p><p>Next, we will subset the two remaining classes of starting materials - <strong>aldehydes</strong> and <strong>methyleneamines</strong> - following the same procedure used for Œ±-amino acids.</p><p>The following workflow will retain only molecules containing <strong>one aldehyde group</strong> (<code>Filter_id = 10</code>) while excluding other reactive or undesired functional groups.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Create a custom filtering workflow for aldehydes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">create_smarts_filters_workflow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">12</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">17</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">21</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">25</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">26</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">35</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">53</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Filter aldehydes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">subset_table_by_smarts_workflow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;emolecules&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p><code>Table &#x27;emolecules_subset_2&#x27; created in: &#x27;/PATH/TO/PROJECT/chemspace/processed_data/chemspace.db&#x27;</code><br>
<code>Succesfully subseted table: &#x27;emolecules&#x27; by SMARTS filters workflow with ID: &#x27;2&#x27;</code></p><p>The <code>emolecules_subset_2</code> table will now contain only aldehyde derivatives suitable for A3 coupling with methyleneamines.</p><p>For <strong>methyleneamines</strong>, we do not have a pre-defined SMARTS filter.<br>
<!-- -->However, TidyScreen provides a specific function for adding custom SMARTS-based filters: <code>add_smarts_filter()</code>.<br>
<!-- -->You simply need to specify the SMARTS pattern and a descriptive filter name.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Add a custom SMARTS filter for primary methylene amines</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_smarts_filter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;[NX3;H2][CX4;H2]&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;Primary_Amines_custom&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p><em>Output</em>: <code>Successfully added SMARTS filter: &#x27;[NX3;H2][CX4;H2]&#x27;</code></p><p>To confirm that the new SMARTS filter was added successfully, you can list all available filters again:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># List available SMARTS filters to obtain reactants</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">list_available_smarts_filters</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p><code>Available SMARTS filters:</code><br>
<code>Filter_id: 1, Filter_Name: Aminoacids, SMARTS: [NX3H2,NX4+H3][CX4H]([*])[CX3H0](=[OX1])[OX2H,OX1-]</code><br>
<code>...</code><br>
<code>Filter_id: 10, Filter_Name: Aldehydes, SMARTS: [CX3H1](=O)[#6]</code><br>
<code>Filter_id: 11, Filter_Name: PrimAmines, SMARTS: [NX3;H2;!$(NC=O)]</code><br>
<code>Filter_id: 12, Filter_Name: SecAmines, SMARTS: [NX3;H1;!$(NC=O)]</code><br>
<code>...</code><br>
<code>Filter_id: 53, Filter_Name: sulfonamide, SMARTS: [SX4](=O)(=O)N</code><br>
<code>Filter_id: 54, Filter_Name: Primary_Amines_custom, SMARTS: [NX3;H2][CX4;H2]</code></p><p>Now that the new filter is available, we can create and apply a corresponding workflow to subset the desired primary methyleneamine derivatives:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Create a custom filtering workflow for primary methylene amines</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">create_smarts_filters_workflow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">54</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">12</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">17</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">21</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">25</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">35</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">53</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Filter primary methylene amines</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">subset_table_by_smarts_workflow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;emolecules&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p><code>Table &#x27;emolecules_subset_3&#x27; created in: &#x27;/PATH/TO/PROJECT/chemspace/processed_data/chemspace.db&#x27;</code><br>
<code>Succesfully subseted table: &#x27;emolecules&#x27; by SMARTS filters workflow with ID: &#x27;3&#x27;</code></p><p>At this point, your chemspace database contains three curated subsets ready for in silico synthesis.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="513---inspection-of-a-sample-of-filtered-building-blocks">5.1.3- üì∏ Inspection of a sample of filtered building blocks<a href="#513---inspection-of-a-sample-of-filtered-building-blocks" class="hash-link" aria-label="Direct link to 5.1.3- üì∏ Inspection of a sample of filtered building blocks" title="Direct link to 5.1.3- üì∏ Inspection of a sample of filtered building blocks">‚Äã</a></h3><p>Before moving forward, it is useful to visually inspect a random sample of compounds from each curated subset to ensure that the filtering process performed as expected.</p><p>TidyScreen provides the function <code>depict_ligand_table()</code>, which automatically generates molecular depictions for a given table in the <strong>chemspace database</strong> and saves them in the <code>processed_data/misc</code> directory.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Depict a random sample of amino acids</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">depict_ligand_table</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;emolecules_subset_1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> limit</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">25</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> random</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Outputs to &#x27;/PATH/TO/PROJECT/chemspace/processed_data/misc&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Depict a random sample of aldehydes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">depict_ligand_table</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;emolecules_subset_2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> limit</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">25</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> random</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Outputs to &#x27;/PATH/TO/PROJECT/chemspace/processed_data/misc&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Depict a random sample of primary methyleneamines</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">depict_ligand_table</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;emolecules_subset_3&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> limit</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">25</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> random</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Outputs to &#x27;/PATH/TO/PROJECT/chemspace/processed_data/misc&#x27;</span><br></span></code></pre></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="52--building-blocks-prioritization">5.2- Building blocks prioritization<a href="#52--building-blocks-prioritization" class="hash-link" aria-label="Direct link to 5.2- Building blocks prioritization" title="Direct link to 5.2- Building blocks prioritization">‚Äã</a></h2><p>In order to narrow down the huge number of potential reactants, we will compute a set of standard <strong>drug-like properties</strong> and apply <strong>Ersilia models</strong> for each curated subset and then <strong>prioritize</strong> entries by applying simple, reproducible property filters.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="521--Ô∏è-subsetting-by-drug-like-properties-rdkit">5.2.1- ‚öóÔ∏è Subsetting by drug-like properties (RDKit)<a href="#521--Ô∏è-subsetting-by-drug-like-properties-rdkit" class="hash-link" aria-label="Direct link to 5.2.1- ‚öóÔ∏è Subsetting by drug-like properties (RDKit)" title="Direct link to 5.2.1- ‚öóÔ∏è Subsetting by drug-like properties (RDKit)">‚Äã</a></h3><p>TidyScreen relies on the open-source cheminformatics toolkit <strong><a href="https://www.rdkit.org/" target="_blank" rel="noopener noreferrer">RDKit</a></strong> to calculate commonly used molecular descriptors directly from SMILES strings.<br>
<!-- -->The following properties are computed by default running the <code>compute_properties()</code> function:</p><ul>
<li><strong>MolWt</strong> ‚Üí Molecular weight</li>
<li><strong>MolLogP</strong> ‚Üí Octanol-water partition coefficient (logP)</li>
<li><strong>NumHDonors</strong> ‚Üí Number of hydrogen bond donors</li>
<li><strong>NumHAcceptors</strong> ‚Üí Number of hydrogen bond acceptors</li>
<li><strong>NumRotatableBonds</strong> ‚Üí Number of rotatable bonds</li>
<li><strong>TPSA</strong> ‚Üí Topological polar surface area</li>
</ul><p>These descriptors are standard in medicinal chemistry and provide a simple first layer of prioritization to retain drug-like, synthetically tractable molecules.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Œ±-Amino acids</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">compute_properties</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;emolecules_subset_1&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Aldehydes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">compute_properties</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;emolecules_subset_2&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Methyleneamines</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">compute_properties</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;emolecules_subset_3&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span></code></pre></div></div><div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>!!!</div><div class="admonitionContent_BuS1"><p>Please note that when running the <code>compute_properties()</code> function you&#x27;ll get the following warning:</p><p><code>The table named &#x27;emolecules_subset_X&#x27; already exists in the database. I will replace it, are you ok with that? (y/n):</code>.</p><p>When prompted, type <em><code>y</code></em> to update the tables with the newly computed properties.</p></div></div><p>üí° Now that all tables contain the computed molecular descriptors, you can explore their value distributions to get a sense of the chemical diversity within each subset.<br>
<!-- -->This helps identify whether your current chemical space fits the intended <em>drug-like</em> range before applying filters.</p><p>With all molecular descriptors available, we can constrain the chemical space to <strong>compounds within defined physicochemical ranges</strong>. This ensures that the selected building blocks remain within desirable regions of drug-like chemical space, minimizing the inclusion of overly flexible, lipophilic/hydrophilic, or bulky structures that may hinder synthesis or bioavailability.</p><p>To perform this filtering, TidyScreen provides the function <code>subset_table_by_properties()</code>, which allows you to select compounds that meet specific descriptor criteria.</p><p>In this example, we keep entries with:</p><ul>
<li>200 ‚â§ MolWt ‚â§ 500</li>
<li>1.5 ‚â§ MolLogP ‚â§ 3.0</li>
<li>NumRotatableBonds ‚â§ 2</li>
</ul><p>To retain compact, moderately lipophilic building blocks with low flexibility.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">drug_like_filters</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;MolWt&gt;=200&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;MolWt&lt;=500&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;MolLogP&gt;=1.5&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;MolLogP&lt;=3&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;NumRotatableBonds&lt;=2&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Œ±-Amino acids</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">subset_table_by_properties</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;emolecules_subset_1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">drug_like_filters</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Aldehydes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">subset_table_by_properties</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;emolecules_subset_2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">drug_like_filters</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Methyleneamines</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">subset_table_by_properties</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;emolecules_subset_3&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">drug_like_filters</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Output</div><div class="admonitionContent_BuS1"><p>When using the <code>subset_table_by_properties()</code> function, you will be prompted to enter a <strong>short description</strong> of the new subset. Being as detailed as possible will help you avoid misunderstandings and ensure clear tracking and reproducibility.</p></div></div><p>After running the filtering step, TidyScreen automatically creates <strong>new tables</strong> inside your project database (<code>chemspace.db</code>). Each of them contains only the compounds that <strong>match all defined property conditions</strong>, effectively reducing the chemical space to its most promising and drug-like entries.</p><p>You can identify these new tables by their names (e.g., <code>emolecules_subset_1_subset_4</code>, <code>emolecules_subset_2_subset_5</code>, etc.), each corresponding to the filtered version of the original subsets.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="522---price-based-prioritization-with-ersilia">5.2.2- üí∏ Price-based prioritization with Ersilia<a href="#522---price-based-prioritization-with-ersilia" class="hash-link" aria-label="Direct link to 5.2.2- üí∏ Price-based prioritization with Ersilia" title="Direct link to 5.2.2- üí∏ Price-based prioritization with Ersilia">‚Äã</a></h3><p>To further improve <strong>synthetic feasibility</strong>, we will estimate reagent prices using an <em>Ersilia Open Source Initiative</em> model and then subset our building blocks by <strong>price ranges</strong>.<br>
<!-- -->The model <code>eos7a45</code> (CopriNet-style predictor) adds a new column to your table (i.e., <code>eos7a45_coprinet</code>) with an estimated price score.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Œ±-Amino acids</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">apply_ersilia_model_on_table</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;emolecules_subset_1_subset_4&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;eos7a45&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Aldehydes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">apply_ersilia_model_on_table</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;emolecules_subset_2_subset_5&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;eos7a45&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Methyleneamines</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">apply_ersilia_model_on_table</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;emolecules_subset_3_subset_6&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;eos7a45&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>To inspect the range of predicted prices (min-max) per subset and set realistic thresholds, we can use  <code>sqlite3</code> in a <em>bash terminal</em>.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sqlite3 $PATH/TO/PROJECT/chemspace/processed_data/chemspace.db \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;SELECT MIN(eos7a45_coprinet), MAX(eos7a45_coprinet) FROM emolecules_subset_1_subset_4 WHERE eos7a45_coprinet IS NOT NULL;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlite3 $PATH/TO/PROJECT/chemspace/processed_data/chemspace.db \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;SELECT MIN(eos7a45_coprinet), MAX(eos7a45_coprinet) FROM emolecules_subset_2_subset_5 WHERE eos7a45_coprinet IS NOT NULL;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlite3 $PATH/TO/PROJECT/chemspace/processed_data/chemspace.db \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;SELECT MIN(eos7a45_coprinet), MAX(eos7a45_coprinet) FROM emolecules_subset_3_subset_6 WHERE eos7a45_coprinet IS NOT NULL;&quot;</span><br></span></code></pre></div></div><p>You should get the following output:</p><p><code>2.66|5.60 #Amino acids</code><br>
<code>1.24|7.24 #Aldehydes</code><br>
<code>2.19|7.09 #Methyleneamines</code></p><p>üí¨ <strong>How to interpret these values</strong></p><p>The <code>eos7a45_coprinet</code> field represents a <strong>predicted cost index ($/mmol)</strong> rather than an absolute monetary price.
Lower scores indicate cheaper, easier-to-source reagents, while higher scores correspond to rarer or more complex compounds.</p><p>These values help define cutoff thresholds that balance cost and chemical diversity, guiding which compounds will be retained for downstream in silico synthesis.</p><p>üßæ <strong>Create tables of ‚Äúcheap, drug-like‚Äù building blocks</strong></p><p>After computing predicted prices with the Ersilia model, we can further refine our chemical space by retaining only those compounds that are both drug-like and synthetically affordable.<br>
<!-- -->This additional filter helps ensure that the selected reagents are not only <em>chemically sound</em> but also <em>economically realistic</em> for laboratory synthesis - a key factor when planning large-scale combinatorial campaigns.</p><p>In this step, we will use <em>bash commands</em> to interact directly with the project‚Äôs SQLite database and create new tables containing only the <strong>cost-effective reagents</strong>, using <code>sqlite3</code> to query the project database (<code>chemspace.db</code>).</p><p>Each line below:</p><ol>
<li>Selects only molecules within the specified price range (<code>BETWEEN X AND Y</code>), and</li>
<li>Stores the result as a new table labeled <code>*_druglike_cheap</code>, ready for the next stages of <em>in silico</em> library construction.</li>
</ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sqlite3 $PATH/TO/PROJECT/chemspace/processed_data/chemspace.db &quot;CREATE TABLE aminoacids_druglike_cheap AS SELECT * FROM emolecules_subset_3_subset_6 WHERE eos7a45_coprinet BETWEEN 1 AND 3.5 AND eos7a45_coprinet IS NOT NULL;&quot; # Returns 83 amino acid building blocks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlite3 $PATH/TO/PROJECT/chemspace/processed_data/chemspace.db &quot;CREATE TABLE aldehydes_druglike_cheap AS SELECT * FROM emolecules_subset_1_subset_4 WHERE eos7a45_coprinet BETWEEN 1 AND 2.3 AND eos7a45_coprinet IS NOT NULL;&quot; # Returns 135 aldehyde building blocks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlite3 $PATH/TO/PROJECT/chemspace/processed_data/chemspace.db &quot;CREATE TABLE amines_druglike_cheap AS SELECT * FROM emolecules_subset_2_subset_5 WHERE eos7a45_coprinet BETWEEN 1 AND 2.6 AND eos7a45_coprinet IS NOT NULL;&quot; # Returns 138 methyleneamine building blocks</span><br></span></code></pre></div></div><p>You now have three price-filtered, drug-like reagent pools ‚Äî <code>aldehydes_druglike_cheap</code>, <code>amines_druglike_cheap</code>, and <code>aminoacids_druglike_cheap</code>.<br>
<!-- -->These curated sets combine <strong>structural suitability</strong>, <strong>favorable physicochemical properties</strong>, and <strong>economic accessibility</strong>, ensuring a realistic starting point for <em>in silico</em> combinatorial synthesis in the next module.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="53--combinatorial-virtual-synthesis">5.3- Combinatorial virtual synthesis<a href="#53--combinatorial-virtual-synthesis" class="hash-link" aria-label="Direct link to 5.3- Combinatorial virtual synthesis" title="Direct link to 5.3- Combinatorial virtual synthesis">‚Äã</a></h2><p>In this section, we will virtually replicate the multistep synthetic route that combines the three types of prioritized building blocks - <strong>amino acids, aldehydes, and methylene amines</strong> - to generate the desired <strong>triazole-based potential TCIs</strong>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="reaction-scheme-overview">Reaction scheme overview<a href="#reaction-scheme-overview" class="hash-link" aria-label="Direct link to Reaction scheme overview" title="Direct link to Reaction scheme overview">‚Äã</a></h4><hr><figure><p align="center"><img src="/TidyScreen_v2_docs_new/img/Synthetic_Scheme_Whorkshop.png" alt="Description of image" width="900"></p><figcaption>General synthetic workflow leading to triazole-based inhibitors. </figcaption><p></p></figure><hr><p>The synthetic plan consists of six consecutive transformations:</p><ol>
<li><strong>Acylation</strong> to prepare an ester intermediate from Œ±-amino acids.</li>
<li><strong>Diazotransfer</strong> to generate Œ±-azido esters.</li>
<li><strong>A3 coupling</strong> to afford <em>propargylamines</em>.</li>
<li><strong>CuAAC reaction</strong> (<em>click chemistry</em>) to form 1,4-disubstituted 1,2,3-triazoles.</li>
<li><strong>DIBAL reduction</strong> to partially reduce carbonyl intermediates.</li>
<li><strong>Horner‚ÄìWadsworth‚ÄìEmmons olefination</strong> to append the <em>phenyl-vinylsulfone warhead</em>.</li>
</ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="smarts-based-combinatorial-synthesis">SMARTS-based combinatorial synthesis<a href="#smarts-based-combinatorial-synthesis" class="hash-link" aria-label="Direct link to SMARTS-based combinatorial synthesis" title="Direct link to SMARTS-based combinatorial synthesis">‚Äã</a></h4><p>TidyScreen uses <strong>SMARTS</strong> to define chemical transformations in a machine-readable way.  Each reaction rule is a <em>pattern-based instruction</em> describing how specific functional groups in reactants (defined before <code>&gt;&gt;</code>) are converted into new substructures in products (defined after <code>&gt;&gt;</code>).</p><p>This approach enables <strong>combinatorial virtual synthesis</strong>, allowing you to simulate multi-step reaction sequences across large datasets of reagents to produce <em>synthetically plausible</em> compound libraries.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="531---defining-smarts-reactions">5.3.1- üß† Defining SMARTS reactions<a href="#531---defining-smarts-reactions" class="hash-link" aria-label="Direct link to 5.3.1- üß† Defining SMARTS reactions" title="Direct link to 5.3.1- üß† Defining SMARTS reactions">‚Äã</a></h3><p>We begin by checking whether any reactions are already defined.
List available SMARTS reactions (empty at first):</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">list_available_smarts_reactions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p><em>Output</em>: <code>SMARTS reactions table does not exist yet. Add reactions to the database first</code>.</p><p>Let‚Äôs now populate the database with the six transformations corresponding to our synthetic route:</p><p>Add the SMARTS reaction for diazotransfer</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_smarts_reaction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;[CX3:1](=[O:2])[OX2H,OX1-:3]&gt;&gt;[C:1](=[O:2])[O:3][C]&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Acylation&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_smarts_reaction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;[NX3;H2:1][CX4:2][CX3,H0:3]&gt;&gt;[N-]=[N+]=[NX2;H0:1][CX4:2][CX3,H0:3]&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Diazotransfer&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_smarts_reaction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;[N:1].[CX3H1:2](=[O:3])&gt;&gt;[NX4+:1][C@H:2][C:4]#[C:5]&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;A3 coupling&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_smarts_reaction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;[NX1-:1]=[NX2+:2]=[NX2:3].[CX2H1:4]#[CX2H0:5]&gt;&gt;[NX2+0:1]1=[NX2+0:2][N:3]-[C:4]=[C:5]1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;CuAAC&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_smarts_reaction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;[CX3:1](=[O:2])[OX2,OX1-:3]&gt;&gt;[CX3H1:1](=[O:2])&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;DIBAL reduction&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_smarts_reaction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;[CX4:1][CX3H1:2](=[O:3])&gt;&gt;[CX4:1]\[CX3H1:2]=[CX3H1]\[S](=O)(=O)c1ccccc1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Horner_Wadsworth_Emmons Olefination&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>We can verify that all reactions were correctly registered:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">list_available_smarts_reactions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p><em>Output</em>:<br>
<code>Available SMARTS reactions:</code><br>
<code>Reaction_id: 1, Name: Acylation</code><br>
<code>Reaction_id: 2, Name: Diazotransfer</code><br>
<code>Reaction_id: 3, Name: A3 coupling</code><br>
<code>Reaction_id: 4, Name: CuAAC</code><br>
<code>Reaction_id: 5, Name: DIBAL reduction</code><br>
<code>Reaction_id: 6, Name: Horner_Wadsworth_Emmons Olefination</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="532---creating-and-applying-a-reaction-workflow">5.3.2- üß™ Creating and applying a reaction workflow<a href="#532---creating-and-applying-a-reaction-workflow" class="hash-link" aria-label="Direct link to 5.3.2- üß™ Creating and applying a reaction workflow" title="Direct link to 5.3.2- üß™ Creating and applying a reaction workflow">‚Äã</a></h3><p>TidyScreen allows the definition of multi-step reaction workflows, enabling sequential application of transformations to progressively build a virtual library.</p><p>Here, we will chain the six reactions defined above into a single workflow that mimics our synthetic plan:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_smarts_reaction_workflow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>List the available workflows to confirm creation:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">list_available_reactions_workflows</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>Now, execute the workflow, specifying which reagent sets participate in each stage. The order and arrows (<code>-&gt;:-1</code>, etc.) indicate how intermediate products feed into the next transformation.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">apply_reaction_workflow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic"># Workflow ID </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;aminoacids_druglike_cheap&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">              </span><span class="token comment" style="color:#999988;font-style:italic"># Step 1: Acylation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;-&gt;:-1&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                                  </span><span class="token comment" style="color:#999988;font-style:italic"># Step 2: Diazotransfer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;amines_druglike_cheap&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;aldehydes_druglike_cheap&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Step 3: A3 coupling</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;-&gt;:-2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;-&gt;:-1&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                         </span><span class="token comment" style="color:#999988;font-style:italic"># Step 4: CuAAC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;-&gt;:-1&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                                  </span><span class="token comment" style="color:#999988;font-style:italic"># Step 5: DIBAL reduction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;-&gt;:-1&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                                   </span><span class="token comment" style="color:#999988;font-style:italic"># Step 6: HWE olefination</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>This process may take several minutes depending on the number of reactants and system resources.
All generated intermediates and final products are automatically stored in the project‚Äôs chemspace database under the name <code>reaction_set_1</code>.</p><p>To get a sense of the diversity and plausibility of your newly generated compounds, you can visualize a random subset of the virtual triazole derivatives:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">depict_ligand_table</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;reaction_set_1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> limit</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">25</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> random</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>The output will generate a grid of 2D structures and save it in <code>/PATH/TO/PROJECT/chemspace/processed_data/misc</code></p><p>This figure provides a quick visual overview of the chemical diversity, substitution patterns, and structural coherence of the in silico library; a valuable sanity check before proceeding to molecular docking.</p><p>‚úÖ You have now constructed a multi-step combinatorial virtual synthesis pipeline, producing a library of triazole-based analogues ready for the next step: virtual screening and docking against CZP and hCatL. Wait... ready? ü§î</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="54--candidates-prioritization">5.4- Candidates prioritization<a href="#54--candidates-prioritization" class="hash-link" aria-label="Direct link to 5.4- Candidates prioritization" title="Direct link to 5.4- Candidates prioritization">‚Äã</a></h2><p>To reduce late-stage attrition and keep <em>wet-lab</em> efforts focused, we will filter the virtual products by <strong>predicted human Drug-Induced Liver Injury (DILI)</strong> using again an <strong>Ersilia</strong> model. Then, we will keep candidates with low predicted totoxicity for the docking stage.</p><p>Here we use the EOS model <code>eos21q7</code>, which provides a probability-like score stored as <code>eos21q7_dili_probability</code> (<em>higher values</em> = <em>greater risk</em>).</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">apply_ersilia_model_on_table</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;reaction_set_1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;eos21q7&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>Query the project database from bash using <code>sqlite3</code> to explore the distribution and set realistic thresholds:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sqlite3 $PATH/TO/PROJECT/chemspace/processed_data/chemspace.db &quot;SELECT MIN(eos21q7_dili_probability), MAX(eos21q7_dili_probability) FROM reaction_set_1 WHERE eos21q7_dili_probability IS NOT NULL;</span><br></span></code></pre></div></div><p><em>Outputs</em>: <code>0.28|0.73</code></p><p>Here we select the 5000 compounds with the lowest predicted toxicity and store them in a new table. Only those compounds will be submitted to molecular docking.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sqlite3 $PATH/TO/PROJECT/chemspace/processed_data/chemspace.db \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;CREATE TABLE candidates_for_docking AS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> SELECT *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> FROM reaction_set_1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> WHERE eos21q7_dili_probability IS NOT NULL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ORDER BY eos21q7_dili_probability ASC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> LIMIT 5000;&quot;</span><br></span></code></pre></div></div><p>According to the same EOS DILI prediction model, the reference inhibitor <strong>K777</strong> exhibits a DILI probability of <code>0.56</code>, indicating a relatively high risk of hepatotoxicity.</p><p>In contrast, the 5000 compounds retained for docking fall within a much safer range (<code>0.28-0.38</code>). This confirms that, beyond synthetic feasibility and drug-likeness, our chemical space is biased toward lower predicted human toxicity, effectively prioritizing compounds with improved safety margins compared to known reference inhibitors.</p><p>üôå You now have a <strong>price-aware, drug-like, synthetically feasible, and low-toxicity</strong> candidate set; effectively defining a <strong>rational and efficient chemical space</strong> for <em>in silico</em> exploration. These compounds are ready for the <strong>virtual screening stage</strong> against <strong>CZP</strong>, followed by <strong>counter-screening</strong> versus <strong>hCatL</strong> to assess selectivity.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="55--vhts">5.5- vHTS<a href="#55--vhts" class="hash-link" aria-label="Direct link to 5.5- vHTS" title="Direct link to 5.5- vHTS">‚Äã</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="551--Ô∏è-molecular-docking-of-prioritized-candidates">5.5.1- ‚öôÔ∏è Molecular docking of prioritized candidates<a href="#551--Ô∏è-molecular-docking-of-prioritized-candidates" class="hash-link" aria-label="Direct link to 5.5.1- ‚öôÔ∏è Molecular docking of prioritized candidates" title="Direct link to 5.5.1- ‚öôÔ∏è Molecular docking of prioritized candidates">‚Äã</a></h3><p>With the chemical space now refined and filtered, we are ready to perform <em>molecular docking</em> of the 5K safest and most promising compounds against <strong>CZP</strong>; and later, for selectivity assessment, against <strong>hCatL</strong>.</p><p>First, prepare all ligands in the <code>candidates_for_docking</code> table.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_cs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">generate_mols_in_table</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;candidates_for_docking&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> conf_rank</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">25</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">300</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pdbqt_method</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;meeko&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> charge_method</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;gas&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>Instantiate a MolDock object to enable access to docking-related functions (If not previusly done in the workflow script):</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_moldock </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> md</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">MolDock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">la_workshop</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>Set the docking campaign using your prepared receptor and validated parameter sets. In this example, we use receptor model 3 (the refined CZP structure) and docking parameters 2.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_moldock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dock_table</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;candidates_for_docking&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                               id_receptor_model</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                               id_docking_params</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>Once the assay is created, TidyScreen automatically generates multiple executable scripts, each containing 1000 docking runs (in total, 5000 compounds = 5 scripts).</p><p>You can launch them directly from the terminal:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">for i in $(seq 1 11); do ./docking_execution_${i}.sh ; done</span><br></span></code></pre></div></div><div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Important</div><div class="admonitionContent_BuS1"><p>Docking execution requires access to a local GPU board or a compatible GPU computing environment. If no GPU resources are available, these scripts cannot be executed, and docking should instead be run on a properly configured workstation or HPC cluster.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="552---docking-results-analysis">5.5.2- üìä Docking results analysis<a href="#552---docking-results-analysis" class="hash-link" aria-label="Direct link to 5.5.2- üìä Docking results analysis" title="Direct link to 5.5.2- üìä Docking results analysis">‚Äã</a></h3><p>After completing the large-scale docking run (<code>assay_6</code>), we can post-process the results and select candidates with the lowest binding energies.
As discussed in the previous tutorials (when working with K777 and the training set), the docking score proved to be the most consistent criterion for identifying bioactive poses. Therefore, we will prioritize it as our primary selection metric here.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Analyze the run and extract only the best pose per ligand (lowest-energy)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_docking_analysis</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">process_docking_assay</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    assay_id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    max_poses</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    extract_poses</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>Use SQL to subset the <strong>Top 100 compounds by docking score</strong>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sqlite3 -header -table docking/docking_assays/assay_6/assay_6.db \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;SELECT LigName, sub_pose, docking_score</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> FROM Results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ORDER BY docking_score ASC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> LIMIT 100;&quot;</span><br></span></code></pre></div></div><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> <b>Output based on docking score</b></summary><div><div class="collapsibleContent_i85q"><div style="font-size:90%"><table><thead><tr><th><strong>LigName</strong></th><th><strong>sub_pose</strong></th><th style="text-align:right"><strong>docking_score</strong></th></tr></thead><tbody><tr><td>CYWLRULGWUKHND-QDRCWIAMSA-O</td><td>CYWLRULGWUKHND-QDRCWIAMSA-O_1</td><td style="text-align:right">-8.15</td></tr><tr><td>AABZCBAGAYRJDZ-ROLKXXGCSA-N</td><td>AABZCBAGAYRJDZ-ROLKXXGCSA-N_1</td><td style="text-align:right">-8.00</td></tr><tr><td>MBTIUSBPXHCMMC-GHDUTYINSA-O</td><td>MBTIUSBPXHCMMC-GHDUTYINSA-O_1</td><td style="text-align:right">-7.99</td></tr><tr><td>ULUDSBKRRIDGPN-LQTKSSSVSA-O</td><td>ULUDSBKRRIDGPN-LQTKSSSVSA-O_1</td><td style="text-align:right">-7.98</td></tr><tr><td>XPIFPVCHVHNQHJ-RILXKHBHSA-O</td><td>XPIFPVCHVHNQHJ-RILXKHBHSA-O_1</td><td style="text-align:right">-7.94</td></tr><tr><td>YKLJSRDWNOQPQO-OQBDGEOBSA-N</td><td>YKLJSRDWNOQPQO-OQBDGEOBSA-N_1</td><td style="text-align:right">-7.94</td></tr><tr><td>VBFTWLUZOOZBPB-RJCWRSEOSA-O</td><td>VBFTWLUZOOZBPB-RJCWRSEOSA-O_1</td><td style="text-align:right">-7.88</td></tr><tr><td>RYFVONWDPDPHHB-ZGCOHECXSA-O</td><td>RYFVONWDPDPHHB-ZGCOHECXSA-O_1</td><td style="text-align:right">-7.81</td></tr><tr><td>NFHBDVKWICVFDQ-APDVVUBJSA-O</td><td>NFHBDVKWICVFDQ-APDVVUBJSA-O_1</td><td style="text-align:right">-7.81</td></tr><tr><td>WERVHOCRXRNYBH-REISJJRISA-O</td><td>WERVHOCRXRNYBH-REISJJRISA-O_1</td><td style="text-align:right">-7.74</td></tr><tr><td>PFZHGYDOQTZDPQ-HUPUPJIPSA-N</td><td>PFZHGYDOQTZDPQ-HUPUPJIPSA-N_1</td><td style="text-align:right">-7.72</td></tr><tr><td>MMKPYJXQEXUYDH-OIBPPNFKSA-O</td><td>MMKPYJXQEXUYDH-OIBPPNFKSA-O_1</td><td style="text-align:right">-7.71</td></tr><tr><td>LLSCRUHCEVGKSQ-XKHREPBBSA-O</td><td>LLSCRUHCEVGKSQ-XKHREPBBSA-O_1</td><td style="text-align:right">-7.70</td></tr><tr><td>DOCNEKCJXXPFEZ-NVOBCCQGSA-O</td><td>DOCNEKCJXXPFEZ-NVOBCCQGSA-O_1</td><td style="text-align:right">-7.68</td></tr><tr><td>DYRCPBZRUZAXIX-JKPVDXOUSA-O</td><td>DYRCPBZRUZAXIX-JKPVDXOUSA-O_1</td><td style="text-align:right">-7.67</td></tr><tr><td>OMQWCNCSDAOYQS-OJPUXPQHSA-O</td><td>OMQWCNCSDAOYQS-OJPUXPQHSA-O_1</td><td style="text-align:right">-7.65</td></tr><tr><td>GEGJOGATSOGXEP-CCVDMMCGSA-O</td><td>GEGJOGATSOGXEP-CCVDMMCGSA-O_1</td><td style="text-align:right">-7.65</td></tr><tr><td>CPECBCLWZCCFIR-DWLBMTHHSA-O</td><td>CPECBCLWZCCFIR-DWLBMTHHSA-O_1</td><td style="text-align:right">-7.61</td></tr><tr><td>JSATUSIYCVGCOF-GXCCJSRQSA-O</td><td>JSATUSIYCVGCOF-GXCCJSRQSA-O_1</td><td style="text-align:right">-7.61</td></tr><tr><td>MSWGHHCHSHNSRS-JMRBFUEQSA-O</td><td>MSWGHHCHSHNSRS-JMRBFUEQSA-O_1</td><td style="text-align:right">-7.60</td></tr><tr><td>UZLBPXKFEJTBJW-QAYYRARUSA-O</td><td>UZLBPXKFEJTBJW-QAYYRARUSA-O_1</td><td style="text-align:right">-7.60</td></tr><tr><td>YQBRHEDHYQJPGY-NVOBCCQGSA-O</td><td>YQBRHEDHYQJPGY-NVOBCCQGSA-O_1</td><td style="text-align:right">-7.60</td></tr><tr><td>KGFVBUCFAKEIIE-HXCDMFHQSA-O</td><td>KGFVBUCFAKEIIE-HXCDMFHQSA-O_1</td><td style="text-align:right">-7.59</td></tr><tr><td>NQZUNDAQXMGKSL-XAWYSJHESA-O</td><td>NQZUNDAQXMGKSL-XAWYSJHESA-O_1</td><td style="text-align:right">-7.59</td></tr><tr><td>QMUPQKJUACHEQD-OUCRSZIVSA-N</td><td>QMUPQKJUACHEQD-OUCRSZIVSA-N_1</td><td style="text-align:right">-7.58</td></tr><tr><td>XBSZIXSVKWJTSD-OGPZQOLISA-O</td><td>XBSZIXSVKWJTSD-OGPZQOLISA-O_1</td><td style="text-align:right">-7.58</td></tr><tr><td>ZLAUXDJLABCRDU-OURVLYCJSA-O</td><td>ZLAUXDJLABCRDU-OURVLYCJSA-O_1</td><td style="text-align:right">-7.57</td></tr><tr><td>UGDNQIHMIAUMOF-LEEQTAOHSA-O</td><td>UGDNQIHMIAUMOF-LEEQTAOHSA-O_1</td><td style="text-align:right">-7.57</td></tr><tr><td>SRXXWAWPFVBRME-HDKPYIOWSA-O</td><td>SRXXWAWPFVBRME-HDKPYIOWSA-O_1</td><td style="text-align:right">-7.57</td></tr><tr><td>YWHRELYUHVGYPT-GLLYUYBOSA-O</td><td>YWHRELYUHVGYPT-GLLYUYBOSA-O_1</td><td style="text-align:right">-7.55</td></tr><tr><td>...</td><td>...</td><td style="text-align:right">...</td></tr><tr><td>YGZRUQQIZMBSDD-XXEOEALZSA-O</td><td>YGZRUQQIZMBSDD-XXEOEALZSA-O_1</td><td style="text-align:right">-7.32</td></tr><tr><td>DDCLCWAKUGQATH-KXZHXVJYSA-O</td><td>DDCLCWAKUGQATH-KXZHXVJYSA-O_1</td><td style="text-align:right">-7.32</td></tr><tr><td>OXUZYRNVCOIXKL-ZGJBHGAESA-O</td><td>OXUZYRNVCOIXKL-ZGJBHGAESA-O_1</td><td style="text-align:right">-7.31</td></tr><tr><td>PRKCCYOLKCDSCQ-LFCSLWFPSA-O</td><td>PRKCCYOLKCDSCQ-LFCSLWFPSA-O_1</td><td style="text-align:right">-7.30</td></tr><tr><td>RBFWAFPREHYGNU-ZEMQAGKDSA-O</td><td>RBFWAFPREHYGNU-ZEMQAGKDSA-O_1</td><td style="text-align:right">-7.30</td></tr><tr><td>DYYZDMIHWINFIF-PXDOLEPXSA-O</td><td>DYYZDMIHWINFIF-PXDOLEPXSA-O_1</td><td style="text-align:right">-7.30</td></tr><tr><td>CCNSRCIALOOJHQ-IYNFVXDOSA-O</td><td>CCNSRCIALOOJHQ-IYNFVXDOSA-O_1</td><td style="text-align:right">-7.29</td></tr><tr><td>FPMTZBSRRXATEP-KQFRVKRDSA-O</td><td>FPMTZBSRRXATEP-KQFRVKRDSA-O_1</td><td style="text-align:right">-7.29</td></tr><tr><td>IJTFVGGDMZVVCY-NEJGVSAFSA-O</td><td>IJTFVGGDMZVVCY-NEJGVSAFSA-O_1</td><td style="text-align:right">-7.29</td></tr><tr><td>JXDRXFUSYAZPDG-SGGLPICOSA-O</td><td>JXDRXFUSYAZPDG-SGGLPICOSA-O_1</td><td style="text-align:right">-7.28</td></tr><tr><td>ABYYJZBHRQSKOH-SFBQEAGJSA-O</td><td>ABYYJZBHRQSKOH-SFBQEAGJSA-O_1</td><td style="text-align:right">-7.28</td></tr><tr><td>YVYRLDPJKNDTKF-FRNNXQESSA-O</td><td>YVYRLDPJKNDTKF-FRNNXQESSA-O_1</td><td style="text-align:right">-7.28</td></tr><tr><td>TZNGNDMWLRPWHC-AKVYSXHKSA-O</td><td>TZNGNDMWLRPWHC-AKVYSXHKSA-O_1</td><td style="text-align:right">-7.28</td></tr><tr><td>MBRMELWIASNFDQ-BTXCHTAFSA-O</td><td>MBRMELWIASNFDQ-BTXCHTAFSA-O_1</td><td style="text-align:right">-7.27</td></tr><tr><td>OIMCTJQEECQBCO-ZGJDELOYSA-O</td><td>OIMCTJQEECQBCO-ZGJDELOYSA-O_1</td><td style="text-align:right">-7.27</td></tr></tbody></table></div></div></div></details><p>Upon inspecting the output, you will notice that the docking scores are considerably more negative than those obtained for K777 bound to CZP (‚âà -4.08 kcal.mol<sup>-1</sup>), suggesting that more stable encounter complexes may have been identified in this large-scale screening.</p><p>To reinforce the validity of these findings, we will now redock the top 100 potential inhibitors to verify reproducibility and ensure that the observed ranking trends remain consistent across independent docking runs.</p><p>Create a table named <code>top_100_CZP_binders</code> to store the selected compounds for further analysis:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sqlite3 chemspace/processed_data/chemspace.db \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;ATTACH DATABASE &#x27;docking/docking_assays/assay_6/assay_6.db&#x27; AS db2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> CREATE TABLE top_100_CZP_binders AS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> SELECT * FROM candidates_for_docking</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> WHERE inchi_key IN (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     SELECT LigName FROM db2.Results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     ORDER BY docking_score ASC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     LIMIT 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> DETACH DATABASE db2;&quot;</span><br></span></code></pre></div></div><p>Create a new docking assay for <code>top_100_CZP_binders</code> using the refined CZP receptor and the validated docking parameters to confirm reproducibility:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_moldock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dock_table</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;top_100_CZP_binders&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    id_receptor_model</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    id_docking_params</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>Analyze the docking results for <code>assay_7</code>:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Extract only the lowest-energy pose per ligand</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_docking_analysis</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">process_docking_assay</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    assay_id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    max_poses</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    extract_poses</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><br></span></code></pre></div></div><p>Finally, compute the MMGBSA energy fingerprints for the newly generated complexes to evaluate their thermodynamic stability:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Provide receptor field indices when prompted</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_docking_analysis</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">compute_fingerprints_for_whole_assay</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    assay_id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mmgbsa</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    prolif</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><br></span></code></pre></div></div><p>Although the detailed results are not displayed here, the redocking step confirmed excellent reproducibility across independent assays. The calculated MMGBSA values were highly consistent with the previous run, showing only minor deviations (~0.2 kcal.mol<sup>-1</sup>) for a few ligands, well within the expected precision range of the method.</p><hr><p>Having validated the workflow and confirmed the robustness of our docking parameters for CZP, the next logical step is to apply the same protocol against the refined hCatL receptor. This comparative analysis will allow us to <strong>identify ligands exhibiting preferential binding to CZP over hCatL</strong>, thus highlighting selectivity determinants relevant for the design of next-generation antichagasic agents.</p><p>Create a new docking assay for <code>top_100_CZP_binders</code> using the refined hCatL receptor and the validated docking parameters to confirm reproducibility:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_moldock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dock_table</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;top_100_CZP_binders&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    id_receptor_model</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    id_docking_params</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>Analyze the docking results for <code>assay_8</code>:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Extract only the lowest-energy pose per ligand</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_docking_analysis</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">process_docking_assay</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    assay_id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    max_poses</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    extract_poses</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><br></span></code></pre></div></div><p>Finally, compute the MMGBSA energy fingerprints for the newly generated complexes to evaluate their thermodynamic stability:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">workshop.py</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Provide receptor field indices when prompted</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">la_workshop_docking_analysis</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">compute_fingerprints_for_whole_assay</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    assay_id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mmgbsa</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    prolif</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><br></span></code></pre></div></div><p>Now that both docking and MMGBSA analyses have been completed for CZP and hCatL, we can directly compare their results to identify ligands that preferentially bind to CZP.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="553---selection-of-candidates-for-synthesis">5.5.3- üéØ Selection of candidates for synthesis<a href="#553---selection-of-candidates-for-synthesis" class="hash-link" aria-label="Direct link to 5.5.3- üéØ Selection of candidates for synthesis" title="Direct link to 5.5.3- üéØ Selection of candidates for synthesis">‚Äã</a></h3><p>The following SQL query joins both assay databases to retrieve, for each compound, the docking scores and MMGBSA total energies obtained against both receptors.
By computing the difference between the values (<code>diff_dock_score</code> and <code>diff_d_g_tot</code>), we can easily pinpoint candidates with improved binding affinity for CZP relative to hCatL.</p><div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Important</div><div class="admonitionContent_BuS1"><p>Please make sure to <strong>replace <code>/PATH/TO/PROJECT/</code></strong> with your <strong>own local or cluster directory path</strong> before running the command below. If not updated, the SQL query will fail because the database cannot be located.</p></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sqlite3 -header -table docking/docking_assays/assay_7/assay_7.db \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;ATTACH DATABASE &#x27;/PATH/TO/PROJECT/docking/docking_assays/assay_8/assay_8.db&#x27; AS db2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> SELECT t1.sub_pose,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        t1.docking_score AS CZP_ds,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        t2.delta_g_total AS CZP_d_g_tot,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        db2.Results.docking_score AS hCatL_ds,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        db2.mmgbsa_fingerprints.delta_g_total AS hCatL_d_g_tot,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ROUND((t1.docking_score - db2.Results.docking_score),2) AS diff_dock_score,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ROUND((t2.delta_g_total - db2.mmgbsa_fingerprints.delta_g_total),2) AS diff_d_g_tot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> FROM Results t1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> JOIN mmgbsa_fingerprints t2 ON t1.LigName = t2.LigName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> JOIN db2.Results ON t1.LigName = db2.Results.LigName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> JOIN db2.mmgbsa_fingerprints ON t1.LigName = db2.mmgbsa_fingerprints.LigName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ORDER BY diff_dock_score ASC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> LIMIT 10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> DETACH DATABASE db2;&quot;</span><br></span></code></pre></div></div><hr><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> <b>Output ranked by docking score difference</b></summary><div><div class="collapsibleContent_i85q"><table><thead><tr><th><strong>sub_pose</strong></th><th style="text-align:right"><strong>CZP_ds</strong></th><th style="text-align:right"><strong>CZP_d_g_tot</strong></th><th style="text-align:right"><strong>hCatL_ds</strong></th><th style="text-align:right"><strong>hCatL_d_g_tot</strong></th><th style="text-align:right"><strong>diff_dock_score</strong></th><th><strong>diff_d_g_tot</strong></th></tr></thead><tbody><tr><td>CUFNDGFOXHNKKU-MGUYBSQASA-O_1</td><td style="text-align:right">-7.24</td><td style="text-align:right">-51.6476</td><td style="text-align:right">-5.85</td><td style="text-align:right">-39.9543</td><td style="text-align:right">-1.39</td><td>-11.69</td></tr><tr><td>CYWLRULGWUKHND-QDRCWIAMSA-O_1</td><td style="text-align:right">-8.09</td><td style="text-align:right">-34.9057</td><td style="text-align:right">-6.73</td><td style="text-align:right">-29.0774</td><td style="text-align:right">-1.36</td><td>-5.83</td></tr><tr><td>TZCGFRFEIJJRGN-VKFROBJISA-N_1</td><td style="text-align:right">-7.44</td><td style="text-align:right">-49.0613</td><td style="text-align:right">-6.20</td><td style="text-align:right">-39.6637</td><td style="text-align:right">-1.24</td><td>-9.40</td></tr><tr><td>GEGJOGATSOGXEP-CCVDMMCGSA-O_1</td><td style="text-align:right">-7.66</td><td style="text-align:right">-39.9591</td><td style="text-align:right">-6.48</td><td style="text-align:right">-38.7983</td><td style="text-align:right">-1.18</td><td>-1.16</td></tr><tr><td>IHRQBMNUDKYYTK-HUAVMZDFSA-N_1</td><td style="text-align:right">-7.28</td><td style="text-align:right">-51.4805</td><td style="text-align:right">-6.24</td><td style="text-align:right">-45.7701</td><td style="text-align:right">-1.04</td><td>-5.71</td></tr><tr><td>DDCLCWAKUGQATH-KXZHXVJYSA-O_1</td><td style="text-align:right">-7.49</td><td style="text-align:right">-42.1068</td><td style="text-align:right">-6.47</td><td style="text-align:right">-41.6397</td><td style="text-align:right">-1.02</td><td>-0.47</td></tr><tr><td>KHUSNQDEVMQYSO-GEKJTBGDSA-O_1</td><td style="text-align:right">-7.51</td><td style="text-align:right">-35.6408</td><td style="text-align:right">-6.59</td><td style="text-align:right">-36.5528</td><td style="text-align:right">-0.92</td><td>0.91</td></tr><tr><td>AABZCBAGAYRJDZ-ROLKXXGCSA-N_1</td><td style="text-align:right">-8.19</td><td style="text-align:right">-38.4541</td><td style="text-align:right">-7.29</td><td style="text-align:right">-44.8960</td><td style="text-align:right">-0.90</td><td>6.44</td></tr><tr><td>MSWGHHCHSHNSRS-JMRBFUEQSA-O_1</td><td style="text-align:right">-7.60</td><td style="text-align:right">-48.8381</td><td style="text-align:right">-6.70</td><td style="text-align:right">-47.1861</td><td style="text-align:right">-0.90</td><td>-1.65</td></tr><tr><td>JXDRXFUSYAZPDG-SGGLPICOSA-O_1</td><td style="text-align:right">-7.29</td><td style="text-align:right">-49.5987</td><td style="text-align:right">-6.45</td><td style="text-align:right">-52.0911</td><td style="text-align:right">-0.84</td><td>2.49</td></tr></tbody></table></div></div></details><p>Upon inspection of the results, we will focus on the two top-scoring ligands according to their docking scores, as they exhibit the most promising binding affinities toward CZP.</p><div style="font-size:90%"><table><thead><tr><th><strong>sub_pose</strong></th><th style="text-align:right"><strong>CZP_ds</strong></th><th style="text-align:right"><strong>CZP_d_g_tot</strong></th><th style="text-align:right"><strong>hCatL_ds</strong></th><th style="text-align:right"><strong>hCatL_d_g_tot</strong></th><th style="text-align:right"><strong>diff_dock_score</strong></th><th><strong>diff_d_g_tot</strong></th></tr></thead><tbody><tr><td>CUFNDGFOXHNKKU-MGUYBSQASA-O_1</td><td style="text-align:right">-7.24</td><td style="text-align:right">-51.6476</td><td style="text-align:right">-5.85</td><td style="text-align:right">-39.9543</td><td style="text-align:right">-1.39</td><td>-11.69</td></tr><tr><td>CYWLRULGWUKHND-QDRCWIAMSA-O_1</td><td style="text-align:right">-8.09</td><td style="text-align:right">-34.9057</td><td style="text-align:right">-6.73</td><td style="text-align:right">-29.0774</td><td style="text-align:right">-1.36</td><td>-5.83</td></tr><tr><td>K777</td><td style="text-align:right">-5.42</td><td style="text-align:right">-50.2336</td><td style="text-align:right">-5.17</td><td style="text-align:right">-43.6419</td><td style="text-align:right">-0.25</td><td>-6.59</td></tr></tbody></table></div><ol>
<li><strong>CUFNDGFOXHNKKU-MGUYBSQASA-O</strong></li>
</ol><p>In the first case, the compound <strong>CUFNDGFOXHNKKU-MGUYBSQASA-O</strong> stands out due to its large affinity gap between CZP and hCatL, both in docking score and MMGBSA; the latter exceeding even the 6.6 kcal.mol<sup>-1</sup> difference observed for K777.</p><p>However, upon visual inspection, we identified a critical issue: this compound was incorrectly generated during the in silico synthesis.</p><hr><figure><p align="center"><img src="/TidyScreen_v2_docs_new/img/CUFNDGFOXHNKKU-MGUYBSQASA-O.png" alt="Description of image" width="400"></p><figcaption>Chemical structure of candidate &#x27;CUFNDGFOXHNKKU-MGUYBSQASA-O&#x27;. </figcaption><p></p></figure><hr><p>Specifically, the nitrile group of the amine derivative (R<sup>3</sup>) was spuriously used as the reacting atom during the A3 coupling step. This misreaction originated from an overly permissive SMARTS pattern of the N in the reaction definition:</p><p><code>la_workshop_cs.add_smarts_reaction(&quot;[N:1].[CX3H1:2](=[O:3])&gt;&gt;[NX4+:1][C@H:2][C:4]#[C:5]&quot;, &quot;A3 coupling&quot;)</code></p><p>This compound was intentionally retained in the dataset for educational purposes, to emphasize the importance of thoroughly validating synthetic rules and performing sanity checks prior to large-scale docking campaigns, avoiding unnecessary computational costs and misinterpretations.</p><p>Having said that, most of the remaining ligands were correctly synthesized, allowing for a reliable comparative analysis of their binding behaviors.</p><ol start="2">
<li><strong>CYWLRULGWUKHND-QDRCWIAMSA-O</strong></li>
</ol><p>This compound exhibits a significant difference in docking score between CZP and hCatL, favoring CZP binding; in contrast to K777, for which the difference was reversed.
However, the ŒîG (MMGBSA) difference is smaller, and the absolute binding energy is also less favorable.</p><p>Nevertheless, visual inspection suggests this is likely the ideal outcome:</p><ul>
<li>For CZP, the predicted pose corresponds to a bioactive conformation, where the warhead is properly oriented toward the catalytic cysteine, and the triazole ring effectively mimics the amide bond through bioisosteric replacement.</li>
<li>Conversely, in hCatL, the predicted pose is not geometrically compatible with covalent inhibition, indicating that this compound could display promising selectivity toward CZP and thus represents a synthetically feasible candidate for further exploration.</li>
</ul><hr><figure><p align="center"><img src="/TidyScreen_v2_docs_new/img/CYWLRULGWUKHND-QDRCWIAMSA-O.png" alt="Description of image" width="400"></p><figcaption>Chemical structure of candidate &#x27;CYWLRULGWUKHND-QDRCWIAMSA-O&#x27;. </figcaption><p></p></figure><hr><div style="display:flex;justify-content:space-around;align-items:center;gap:20px"><figure style="text-align:center;flex:1"><img src="/TidyScreen_v2_docs_new/img/CYWLRULGWUKHND-QDRCWIAMSA-O-CZP.png" alt="CZP fingerprint" width="285"><figcaption><b>CYWLRULGWUKHND-QDRCWIAMSA-O bound to CZP</b></figcaption></figure><figure style="text-align:center;flex:1"><img src="/TidyScreen_v2_docs_new/img/CYWLRULGWUKHND-QDRCWIAMSA-O-CatL.png" alt="hCatL fingerprint" width="450"><figcaption><b>CYWLRULGWUKHND-QDRCWIAMSA-O bound to hCatL</b></figcaption></figure></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="-56--summary-of-the-chemical-space-exploration">üß© 5.6- Summary of the Chemical Space Exploration<a href="#-56--summary-of-the-chemical-space-exploration" class="hash-link" aria-label="Direct link to üß© 5.6- Summary of the Chemical Space Exploration" title="Direct link to üß© 5.6- Summary of the Chemical Space Exploration">‚Äã</a></h2><p>Taken together, this small-scale benchmark exemplifies the diversity of outcomes that can emerge from rational in silico design workflows.
Among the top-ranked ligands, we identified two representative cases:</p><ul>
<li>
<p>a <strong>synthetic artefact</strong> (<em>CUFNDGFOXHNKKU-MGUYBSQASA-O</em>), which highlights the need for <strong>rigorous validation</strong> of virtual reaction schemes and filters before large-scale screening; and</p>
</li>
<li>
<p>a <strong>selective inhibitor candidate</strong> (<em>CYWLRULGWUKHND-QDRCWIAMSA-O</em>), favoring CZP over hCatL and reproducing a bioactive-like orientation.</p>
</li>
</ul><p>Altogether, these findings illustrate how in silico chemical space exploration can efficiently combine synthetic accessibility, predicted safety, and mechanistic insight to refine candidate selection before synthesis.</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> <b>üí≠ WHAT IF...? </b></summary><div><div class="collapsibleContent_i85q"><p>So far, we have relied on manual inspection and energetic metrics (Docking score, ŒîG<sub>MMGBSA</sub>) to evaluate candidate poses.
But what if we could go one step further, quantifying the per-residue interactions and learning from them automatically?</p><p>Each docking result already contains per-residue interaction fingerprints, which can be extracted directly from the <code>mmgbsa_fingerprints</code> table as shown below:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sqlite3 docking/docking_assays/assay_2/assay_2.db \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;SELECT writefile(&#x27;fp_K777-CZP.csv&#x27;, mmgbsa_csv_file) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> FROM mmgbsa_fingerprints </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> WHERE sub_pose = &#x27;RHJLQMVZXQKJKB-FPHSVDBKSA-N_1&#x27;;&quot;  # K777 bound to CZP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlite3 docking/docking_assays/assay_4/assay_4.db \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;SELECT writefile(&#x27;fp_K777-hCatL.csv&#x27;, mmgbsa_csv_file) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> FROM mmgbsa_fingerprints </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> WHERE sub_pose = &#x27;RHJLQMVZXQKJKB-FPHSVDBKSA-N_1&#x27;;&quot;  # K777 bound to hCatL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlite3 docking/docking_assays/assay_7/assay_7.db \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;SELECT writefile(&#x27;fp_CYWLRULGWUKHND-QDRCWIAMSA-O_1-CZP.csv&#x27;, mmgbsa_csv_file) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> FROM mmgbsa_fingerprints </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> WHERE sub_pose = &#x27;CYWLRULGWUKHND-QDRCWIAMSA-O_1&#x27;;&quot;  # Candidate bound to CZP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlite3 docking/docking_assays/assay_8/assay_8.db \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;SELECT writefile(&#x27;fp_CYWLRULGWUKHND-QDRCWIAMSA-O_1-hCatL.csv&#x27;, mmgbsa_csv_file) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> FROM mmgbsa_fingerprints </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> WHERE sub_pose = &#x27;CYWLRULGWUKHND-QDRCWIAMSA-O_1&#x27;;&quot;  # Candidate bound to hCatL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div><p>These CSV files encode per-residue contributions (vdW, electrostatics, solvation, etc.), enabling:</p><ul>
<li>automated filtering of poses that reproduce key binding interactions (&quot;hotspots&quot;),</li>
<li>quantitative comparison across targets, and</li>
<li>use as training data for machine learning classifiers, capable of distinguishing bioactive from non-bioactive binding modes.</li>
</ul><p>In practice, this approach can drastically reduce the need for visual inspection while providing interpretable molecular descriptors for downstream AI-driven design pipelines.</p><p>üîç <strong>Comparative analysis of interaction fingerprints</strong></p><table><thead><tr><th>CZP fingerprint</th><th>hCatL fingerprint</th></tr></thead><tbody><tr><td><img decoding="async" loading="lazy" src="/TidyScreen_v2_docs_new/assets/images/mmgbsa_group_total_by_residue_CZP-0d19bea14cbc9ef783ee4d5757ca4852.png" width="1620" height="1767" class="img_ev3q"></td><td><img decoding="async" loading="lazy" src="/TidyScreen_v2_docs_new/assets/images/mmgbsa_group_total_by_residue_hCatL-105ed67ff1519ac7276c8525706fb6d4.png" width="1619" height="1767" class="img_ev3q"></td></tr></tbody></table><p>In this example, K777 exhibits a similar interaction pattern across both targets, as expected for a non-selective covalent inhibitor.</p><p>In contrast, the compound <em>CYWLRULGWUKHND-QDRCWIAMSA-O</em> shows a marked difference in interaction profiles:</p><ul>
<li>Gln19 (CZP) / Gln20 (hCatL), both residues belong to the oxyanion hole, essential for catalytic stabilization.</li>
<li>HIP162 (CZP) / HIP164 (hCatL), the histidine partner of Cys25/Cys26 forming the catalytic dyad.</li>
</ul><p>Had we applied an interaction-based filter requiring the satisfaction of these two key contacts, the analysis would have automatically identified <em>CYWLRULGWUKHND-QDRCWIAMSA-O</em> as a CZP-selective binder.</p></div></div></details></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/examples/LA_Workshop/exploring_chemical_space.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/TidyScreen_v2_docs_new/docs/examples/LA_Workshop/modeling_a_training_set"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">4. Evaluation of a training set</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/TidyScreen_v2_docs_new/docs/examples/LA_Workshop/conclusions"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">6. Key Takeaways</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview-of-the-protocol" class="table-of-contents__link toc-highlight">Overview of the Protocol</a></li><li><a href="#51--extraction-of-building-blocks" class="table-of-contents__link toc-highlight">5.1- <strong>Extraction of building blocks</strong></a><ul><li><a href="#511--Ô∏è-import-emolecules-database" class="table-of-contents__link toc-highlight">5.1.1- üóÇÔ∏è Import eMolecules database</a></li><li><a href="#512---chemical-scaffolds-filtering" class="table-of-contents__link toc-highlight">5.1.2- üß© Chemical scaffolds filtering</a></li><li><a href="#513---inspection-of-a-sample-of-filtered-building-blocks" class="table-of-contents__link toc-highlight">5.1.3- üì∏ Inspection of a sample of filtered building blocks</a></li></ul></li><li><a href="#52--building-blocks-prioritization" class="table-of-contents__link toc-highlight">5.2- Building blocks prioritization</a><ul><li><a href="#521--Ô∏è-subsetting-by-drug-like-properties-rdkit" class="table-of-contents__link toc-highlight">5.2.1- ‚öóÔ∏è Subsetting by drug-like properties (RDKit)</a></li><li><a href="#522---price-based-prioritization-with-ersilia" class="table-of-contents__link toc-highlight">5.2.2- üí∏ Price-based prioritization with Ersilia</a></li></ul></li><li><a href="#53--combinatorial-virtual-synthesis" class="table-of-contents__link toc-highlight">5.3- Combinatorial virtual synthesis</a><ul><li><a href="#531---defining-smarts-reactions" class="table-of-contents__link toc-highlight">5.3.1- üß† Defining SMARTS reactions</a></li><li><a href="#532---creating-and-applying-a-reaction-workflow" class="table-of-contents__link toc-highlight">5.3.2- üß™ Creating and applying a reaction workflow</a></li></ul></li><li><a href="#54--candidates-prioritization" class="table-of-contents__link toc-highlight">5.4- Candidates prioritization</a></li><li><a href="#55--vhts" class="table-of-contents__link toc-highlight">5.5- vHTS</a><ul><li><a href="#551--Ô∏è-molecular-docking-of-prioritized-candidates" class="table-of-contents__link toc-highlight">5.5.1- ‚öôÔ∏è Molecular docking of prioritized candidates</a></li><li><a href="#552---docking-results-analysis" class="table-of-contents__link toc-highlight">5.5.2- üìä Docking results analysis</a></li><li><a href="#553---selection-of-candidates-for-synthesis" class="table-of-contents__link toc-highlight">5.5.3- üéØ Selection of candidates for synthesis</a></li></ul></li><li><a href="#-56--summary-of-the-chemical-space-exploration" class="table-of-contents__link toc-highlight">üß© 5.6- Summary of the Chemical Space Exploration</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/TidyScreen_v2_docs_new/docs/documentation_index">Documentation</a></li><li class="footer__item"><a class="footer__link-item" href="/TidyScreen_v2_docs_new/docs/contact">Contact</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">MedChemLab - Faculty of Chemical Sciences, National University of C√≥rdoba, Argentina. 2025.</div></div></div></footer></div>
</body>
</html>